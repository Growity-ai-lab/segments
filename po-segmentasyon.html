<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A.T.L.A.S | PO Premium Market | Growity AI Studio</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700;800&family=Space+Mono:wght@400;700&family=Sora:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --bg-primary: #0a0a0f; --bg-secondary: #12121a; --bg-card: #1a1a24; --accent-blue: #00d4ff; --accent-purple: #7c3aed; --accent-orange: #ff6b35; --accent-green: #10b981; --accent-yellow: #f59e0b; --accent-pink: #ec4899; --accent-red: #e31e24; --text-primary: #f0f0f5; --text-secondary: #8888a0; --border-color: #2a2a3a; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Sora', sans-serif; background: var(--bg-primary); color: var(--text-primary); min-height: 100vh; overflow-x: hidden; }
        .bg-grid { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-image: linear-gradient(rgba(227, 30, 36, 0.02) 1px, transparent 1px), linear-gradient(90deg, rgba(227, 30, 36, 0.02) 1px, transparent 1px); background-size: 50px 50px; pointer-events: none; z-index: 0; }
        .header { background: rgba(10,10,15,0.95); border-bottom: 1px solid var(--border-color); padding: 12px 20px; display: flex; justify-content: space-between; align-items: center; position: relative; z-index: 10; backdrop-filter: blur(20px); }
        .header-left { display: flex; align-items: center; gap: 16px; }
        .nav-btn { padding: 8px 14px; border: 1px solid var(--border-color); border-radius: 8px; background: var(--bg-card); color: var(--text-primary); font-size: 12px; font-family: 'Sora', sans-serif; cursor: pointer; text-decoration: none; transition: all 0.3s; }
        .nav-btn:hover { border-color: var(--accent-blue); background: rgba(0,212,255,0.1); }
        .logo { display: flex; align-items: center; gap: 12px; }
        .logo-icon { width: 44px; height: 44px; }
        .logo-icon svg { width: 100%; height: 100%; }
        /* Globe animations */
        .globe-outer { animation: rotateRing 20s linear infinite; transform-origin: center; }
        .globe-mid { animation: rotateRing 15s linear infinite reverse; transform-origin: center; }
        .globe-inner { animation: pulseRing 3s ease-in-out infinite; transform-origin: center; }
        .globe-lat { animation: wobbleLat 8s ease-in-out infinite; transform-origin: center; }
        .globe-long { animation: wobbleLong 10s ease-in-out infinite; transform-origin: center; }
        .globe-center { animation: centerPulse 2s ease-in-out infinite; transform-origin: center; }
        .cardinal-point:nth-child(1) { animation: orbitTop 8s ease-in-out infinite; transform-origin: 22px 22px; }
        .cardinal-point:nth-child(2) { animation: orbitRight 10s ease-in-out infinite; transform-origin: 22px 22px; }
        .cardinal-point:nth-child(3) { animation: orbitBottom 7s ease-in-out infinite; transform-origin: 22px 22px; }
        .cardinal-point:nth-child(4) { animation: orbitLeft 9s ease-in-out infinite; transform-origin: 22px 22px; }
        .seg-1 { animation: floatSeg1 6s ease-in-out infinite; }
        .seg-2 { animation: floatSeg2 7s ease-in-out infinite; }
        .seg-3 { animation: floatSeg3 5s ease-in-out infinite; }
        .seg-4 { animation: floatSeg4 8s ease-in-out infinite; }
        @keyframes rotateRing { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes pulseRing { 0%, 100% { transform: scale(1); opacity: 0.5; } 50% { transform: scale(1.08); opacity: 0.8; } }
        @keyframes wobbleLat { 0%, 100% { transform: scaleY(1); } 50% { transform: scaleY(1.15); } }
        @keyframes wobbleLong { 0%, 100% { transform: scaleX(1); } 50% { transform: scaleX(1.15); } }
        @keyframes centerPulse { 0%, 100% { transform: scale(1); filter: drop-shadow(0 0 3px rgba(0,212,255,0.6)); } 50% { transform: scale(1.2); filter: drop-shadow(0 0 8px rgba(124,58,237,0.8)); } }
        @keyframes orbitTop { 0%, 100% { transform: translate(0, 0) scale(1); } 50% { transform: translate(5px, 3px) scale(1.15); } }
        @keyframes orbitRight { 0%, 100% { transform: translate(0, 0) scale(1); } 50% { transform: translate(-4px, 5px) scale(1.1); } }
        @keyframes orbitBottom { 0%, 100% { transform: translate(0, 0) scale(1); } 50% { transform: translate(-5px, -3px) scale(1.2); } }
        @keyframes orbitLeft { 0%, 100% { transform: translate(0, 0) scale(1); } 50% { transform: translate(4px, -5px) scale(1.1); } }
        @keyframes floatSeg1 { 0%, 100% { transform: translate(0, 0) scale(1); } 50% { transform: translate(-2px, 2px) scale(1.2); } }
        @keyframes floatSeg2 { 0%, 100% { transform: translate(0, 0) scale(1); } 50% { transform: translate(2px, -2px) scale(1.15); } }
        @keyframes floatSeg3 { 0%, 100% { transform: translate(0, 0) scale(1); } 50% { transform: translate(3px, 2px) scale(1.25); } }
        @keyframes floatSeg4 { 0%, 100% { transform: translate(0, 0) scale(1); } 50% { transform: translate(-2px, -3px) scale(1.1); } }
        .logo-text { display: flex; flex-direction: column; }
        .logo-text .brand { font-family: 'Outfit', sans-serif; font-size: 18px; font-weight: 800; letter-spacing: 1.5px; background: linear-gradient(135deg, #00d4ff 0%, #7c3aed 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; line-height: 1.2; }
        .logo-text .tagline { font-size: 7px; font-family: 'Space Mono', monospace; color: var(--text-secondary); letter-spacing: 0.2px; margin-top: 1px; }
        .logo-text .powered-by { display: flex; align-items: center; gap: 4px; font-size: 7px; color: var(--text-secondary); margin-top: 3px; }
        .logo-text .powered-by .growity-name { font-weight: 600; background: linear-gradient(90deg, #E91E8C, #7B2D8E); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .po-badge { display: flex; align-items: center; gap: 8px; background: rgba(227,30,36,0.15); border: 1px solid rgba(227,30,36,0.4); padding: 8px 14px; border-radius: 10px; margin-left: 16px; }
        .po-icon { width: 28px; height: 28px; background: linear-gradient(135deg, #e31e24, #c41e24); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 10px; font-family: 'Space Mono', monospace; }
        .po-text { font-size: 13px; font-weight: 600; color: #fff; }
        .header-actions { display: flex; gap: 10px; align-items: center; }
        /* === PRE-SEGMENTS DROPDOWN === */
        .pre-segments-dropdown { position: relative; }
        .pre-segments-btn { display: flex; align-items: center; gap: 8px; padding: 10px 16px; background: linear-gradient(135deg, rgba(124,58,237,0.15), rgba(0,212,255,0.1)); border: 1px solid rgba(124,58,237,0.4); border-radius: 10px; color: var(--text-primary); font-size: 11px; font-weight: 500; cursor: pointer; transition: all 0.2s; font-family: 'Sora', sans-serif; }
        .pre-segments-btn:hover { border-color: var(--accent-purple); transform: translateY(-1px); }
        .pre-segments-btn .dropdown-arrow { font-size: 8px; transition: transform 0.2s; margin-left: 4px; }
        .pre-segments-btn .dropdown-arrow.rotated { transform: rotate(180deg); }
        .pre-segments-menu { display: none; position: absolute; top: calc(100% + 8px); right: 0; min-width: 220px; background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 12px; padding: 8px; box-shadow: 0 10px 40px rgba(0,0,0,0.4); z-index: 100; animation: dropdownFadeIn 0.2s ease; }
        .pre-segments-menu.visible { display: block; }
        @keyframes dropdownFadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .pre-segments-group { margin-bottom: 8px; }
        .pre-segments-group:last-child { margin-bottom: 0; }
        .pre-segments-group-title { display: flex; align-items: center; gap: 8px; padding: 8px 12px; font-size: 10px; font-weight: 600; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 1px solid var(--border-color); margin-bottom: 4px; }
        .pre-segments-item { display: flex; align-items: center; gap: 10px; padding: 10px 12px; border-radius: 8px; color: var(--text-primary); text-decoration: none; font-size: 11px; transition: all 0.2s; }
        .pre-segments-item:hover { background: rgba(255,255,255,0.05); }
        .pre-segments-item.main { border-left: 3px solid var(--accent-blue); }
        .pre-segments-item.main:hover { background: rgba(0,212,255,0.1); }
        .pre-segments-item.quadrant { border-left: 3px solid var(--accent-purple); }
        .pre-segments-item.quadrant:hover { background: rgba(124,58,237,0.1); }
        .pre-segments-item.enerjisa { border-left: 3px solid #ffc107; }
        .pre-segments-item.enerjisa:hover { background: rgba(255,193,7,0.1); }
        .pre-segments-item.active { background: rgba(227,30,36,0.15); border-left: 3px solid var(--accent-red); }
        .btn { padding: 10px 16px; border: none; border-radius: 8px; font-size: 11px; font-weight: 600; font-family: 'Sora', sans-serif; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 6px; }
        .btn-secondary { background: var(--bg-card); border: 1px solid var(--border-color); color: var(--text-primary); }
        .btn-secondary:hover { border-color: var(--accent-red); background: rgba(227,30,36,0.1); }
        .main-wrapper { display: flex; flex-direction: column; height: calc(100vh - 68px); overflow: hidden; position: relative; z-index: 1; }
        .top-section { display: flex; flex: 1; min-height: 0; overflow: hidden; }
        .left-panel { width: 220px; background: rgba(26,26,36,0.8); border-right: 1px solid var(--border-color); display: flex; flex-direction: column; backdrop-filter: blur(10px); }
        .panel-header { padding: 14px; border-bottom: 1px solid var(--border-color); }
        .panel-title { font-size: 12px; font-weight: 600; margin-bottom: 10px; }
        .filter-row { display: flex; gap: 4px; flex-wrap: wrap; }
        .filter-btn { padding: 5px 8px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-card); color: var(--text-secondary); font-size: 10px; font-family: 'Space Mono', monospace; cursor: pointer; transition: all 0.2s; }
        .filter-btn:hover { border-color: var(--accent-red); color: var(--text-primary); }
        .filter-btn.active { background: rgba(227,30,36,0.2); border-color: var(--accent-red); color: var(--accent-red); }
        .segment-list { flex: 1; overflow-y: auto; padding: 8px; }
        .segment-group { margin-bottom: 6px; }
        .segment-group-header { display: flex; align-items: center; justify-content: space-between; padding: 8px 10px; background: var(--bg-card); border-radius: 8px; cursor: pointer; font-size: 10px; font-weight: 600; border-left: 3px solid #666; transition: all 0.2s; }
        .segment-group-header:hover { background: rgba(255,255,255,0.05); }
        .segment-items { max-height: 0; overflow: hidden; transition: max-height 0.3s; }
        .segment-items.open { max-height: 400px; }
        .segment-item { display: flex; align-items: center; gap: 8px; padding: 8px 10px; border-radius: 6px; cursor: pointer; margin-top: 4px; font-size: 10px; transition: all 0.2s; background: var(--bg-secondary); }
        .segment-item:hover { background: rgba(0,212,255,0.05); }
        .segment-item.selected { background: rgba(227,30,36,0.15); border: 1px solid rgba(227,30,36,0.3); }
        .tier-badge { min-width: 20px; height: 16px; display: flex; align-items: center; justify-content: center; border-radius: 4px; font-size: 8px; font-weight: bold; font-family: 'Space Mono', monospace; }
        .tier-super { background: linear-gradient(135deg, #ffd700, #ffaa00); color: #000; }
        .tier-t1 { background: var(--accent-green); color: #fff; }
        .tier-t2 { background: var(--accent-blue); color: #000; }
        .tier-t3 { background: var(--accent-orange); color: #000; }
        .tier-t4 { background: var(--accent-red); color: #fff; }
        .center-panel { flex: 1; display: flex; flex-direction: column; padding: 12px; min-width: 0; }
        .canvas-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .canvas-title { font-size: 13px; font-weight: 600; font-family: 'Space Mono', monospace; }
        .view-toggle { display: flex; background: var(--bg-card); border-radius: 8px; padding: 3px; border: 1px solid var(--border-color); }
        .view-btn { padding: 6px 10px; border: none; background: transparent; color: var(--text-secondary); font-size: 9px; font-family: 'Sora', sans-serif; cursor: pointer; border-radius: 5px; transition: all 0.2s; }
        .view-btn:hover { color: var(--text-primary); }
        .view-btn.active { background: rgba(227,30,36,0.3); color: #fff; }
        .canvas-wrap { flex: 1; background: var(--bg-card); border-radius: 12px; border: 1px solid var(--border-color); position: relative; }
        #quadrantCanvas { width: 100%; height: 100%; }
        .right-panel { width: 320px; background: rgba(26,26,36,0.8); border-left: 1px solid var(--border-color); display: flex; flex-direction: column; overflow-y: auto; backdrop-filter: blur(10px); }
        .detail-section { padding: 14px; border-bottom: 1px solid var(--border-color); }
        .detail-title { font-size: 10px; font-weight: 600; color: var(--text-secondary); text-transform: uppercase; margin-bottom: 10px; font-family: 'Space Mono', monospace; letter-spacing: 1px; }
        .detail-header { display: flex; align-items: center; gap: 10px; }
        .detail-name { font-size: 14px; font-weight: 600; }
        .detail-parent { font-size: 10px; color: var(--text-secondary); }
        .metrics-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px; }
        .metric-box { background: var(--bg-secondary); border-radius: 8px; padding: 8px 4px; text-align: center; border: 1px solid var(--border-color); }
        .metric-value { font-size: 14px; font-weight: 700; color: var(--accent-red); font-family: 'Space Mono', monospace; }
        .metric-label { font-size: 8px; color: var(--text-secondary); margin-top: 2px; }
        .strategy-card { background: var(--bg-secondary); border-radius: 10px; padding: 12px; border: 1px solid var(--border-color); margin-bottom: 10px; }
        .strategy-title { font-size: 11px; font-weight: 600; color: var(--accent-green); margin-bottom: 8px; }
        .strategy-text { font-size: 11px; line-height: 1.5; color: var(--text-primary); }
        .strategy-reason { font-size: 10px; color: var(--text-secondary); margin-top: 8px; padding-top: 8px; border-top: 1px solid var(--border-color); }
        .strategy-tags { display: flex; flex-wrap: wrap; gap: 4px; margin-top: 8px; }
        .strategy-tag { font-size: 9px; padding: 3px 8px; border-radius: 12px; background: rgba(0,212,255,0.15); color: var(--accent-blue); font-family: 'Space Mono', monospace; }
        .platform-reach-section { margin-top: 6px; }
        .reach-bars { display: flex; flex-direction: column; gap: 6px; }
        .reach-item { display: flex; align-items: center; gap: 8px; }
        .reach-platform { font-size: 9px; color: var(--text-secondary); width: 55px; font-family: 'Space Mono', monospace; }
        .reach-bar-wrap { flex: 1; height: 14px; background: var(--bg-card); border-radius: 7px; overflow: hidden; position: relative; }
        .reach-bar { height: 100%; border-radius: 7px; transition: width 0.5s ease; }
        .reach-bar.meta { background: linear-gradient(90deg, #1877f2, #4a90d9); }
        .reach-bar.youtube { background: linear-gradient(90deg, #ff0000, #ff6666); }
        .reach-bar.tiktok { background: linear-gradient(90deg, #00f2ea, #ff0050); }
        .reach-bar.x { background: linear-gradient(90deg, #333, #666); }
        .reach-bar.dv360 { background: linear-gradient(90deg, #34a853, #4ade80); }
        .reach-value { font-size: 10px; font-weight: 600; color: var(--text-primary); width: 36px; text-align: right; font-family: 'Space Mono', monospace; }
        .bottom-panel { background: rgba(20,20,35,0.98); border-top: 2px solid var(--accent-red); height: 0; overflow: hidden; transition: height 0.3s; position: relative; z-index: 100; }
        .bottom-panel.active { height: 380px; overflow-y: auto; }
        .bottom-content { padding: 16px 20px; }
        .bottom-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
        .bottom-title { font-size: 14px; font-weight: 600; display: flex; align-items: center; gap: 10px; }
        .bottom-subtitle { font-size: 11px; color: var(--text-secondary); font-family: 'Space Mono', monospace; }
        .close-btn { width: 32px; height: 32px; border-radius: 8px; border: 1px solid var(--border-color); background: var(--bg-card); color: var(--text-secondary); font-size: 14px; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: center; }
        .close-btn:hover { border-color: var(--accent-red); color: var(--accent-red); background: rgba(227,30,36,0.1); }
        .bottom-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .bht-impact-section { background: var(--bg-card); border-radius: 12px; padding: 16px; border: 1px solid var(--border-color); }
        .bht-impact-title { font-size: 12px; font-weight: 600; margin-bottom: 14px; color: var(--accent-blue); font-family: 'Space Mono', monospace; }
        .bht-category { margin-bottom: 12px; }
        .bht-category-header { font-size: 11px; font-weight: 600; padding: 8px 10px; border-radius: 8px; margin-bottom: 6px; display: flex; justify-content: space-between; align-items: center; }
        .bht-category-header.awareness { background: rgba(124,58,237,0.2); color: #a78bfa; }
        .bht-category-header.consideration { background: rgba(245,158,11,0.2); color: #fbbf24; }
        .bht-category-header.conversion { background: rgba(16,185,129,0.2); color: #34d399; }
        .bht-impact-value { font-size: 13px; font-weight: 700; font-family: 'Space Mono', monospace; }
        .bht-questions-list { font-size: 10px; color: var(--text-secondary); padding-left: 10px; }
        .bht-question-item { padding: 4px 0; display: flex; align-items: center; gap: 6px; }
        .bht-question-item.recommended { color: var(--text-primary); }
        .bht-question-item.recommended::before { content: '‚òÖ'; color: var(--accent-red); }
        .platform-section { background: var(--bg-card); border-radius: 12px; padding: 16px; border: 1px solid var(--border-color); }
        .platform-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; }
        .platform-card { background: var(--bg-secondary); border-radius: 10px; overflow: hidden; border: 1px solid var(--border-color); }
        .platform-header { padding: 8px 10px; font-size: 10px; font-weight: 600; font-family: 'Space Mono', monospace; }
        .platform-header.meta { background: rgba(24,119,242,0.2); color: #60a5fa; border-bottom: 2px solid #1877f2; }
        .platform-header.x { background: rgba(255,255,255,0.1); color: #fff; border-bottom: 2px solid #fff; }
        .platform-header.tiktok { background: rgba(0,242,234,0.15); color: #00f2ea; border-bottom: 2px solid #00f2ea; }
        .platform-header.youtube { background: rgba(255,0,0,0.15); color: #f87171; border-bottom: 2px solid #ff0000; }
        .platform-header.dv360 { background: rgba(52,168,83,0.2); color: #4ade80; border-bottom: 2px solid #34a853; }
        .platform-body { padding: 8px; }
        .targeting-row { display: flex; justify-content: space-between; padding: 4px 0; border-bottom: 1px solid rgba(255,255,255,0.05); font-size: 9px; }
        .targeting-row:last-child { border-bottom: none; }
        .targeting-type { color: var(--text-secondary); }
        .targeting-value { color: var(--text-primary); text-align: right; max-width: 65%; }
        .bht-mini { font-size: 7px; padding: 2px 4px; border-radius: 4px; margin-left: 4px; font-family: 'Space Mono', monospace; }
        .bht-mini.aw { background: rgba(124,58,237,0.3); color: #a78bfa; }
        .bht-mini.co { background: rgba(245,158,11,0.3); color: #fbbf24; }
        .bht-mini.cv { background: rgba(16,185,129,0.3); color: #34d399; }
        .extra-targeting-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 14px; }
        .extra-targeting-card { background: var(--bg-secondary); border-radius: 10px; overflow: hidden; border: 1px solid var(--border-color); }
        .extra-targeting-header { padding: 8px 10px; font-size: 10px; font-weight: 600; background: rgba(255,255,255,0.05); color: var(--accent-blue); border-bottom: 1px solid var(--border-color); font-family: 'Space Mono', monospace; }
        .extra-targeting-body { padding: 8px 10px; }
        .extra-item { display: flex; align-items: center; gap: 8px; padding: 4px 0; font-size: 10px; border-bottom: 1px solid rgba(255,255,255,0.03); }
        .extra-item:last-child { border-bottom: none; }
        .extra-item-icon { width: 6px; height: 6px; border-radius: 50%; }
        .extra-item-icon.lifestyle { background: var(--accent-purple); }
        .extra-item-icon.affinity { background: var(--accent-green); }
        .extra-item-icon.inmarket { background: var(--accent-orange); }
        .empty-state { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; color: var(--text-secondary); text-align: center; padding: 24px; }
        .empty-icon { font-size: 36px; margin-bottom: 10px; opacity: 0.5; }
        .tooltip { position: fixed; background: rgba(26,26,36,0.98); padding: 12px 16px; border-radius: 10px; font-size: 11px; pointer-events: none; z-index: 1000; display: none; max-width: 260px; border: 1px solid var(--border-color); backdrop-filter: blur(20px); box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg-secondary); }
        ::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--accent-red); }
        
        /* === UI/UX PRO MAX ENHANCEMENTS === */
        
        /* Cursor pointer for all interactive elements */
        button, a, [onclick], [role="button"], .nav-btn, .btn, .filter-btn, .view-btn, .segment-item, .segment-group-header, .platform-tab, .bht-question-item { cursor: pointer; }
        
        /* Smooth transitions */
        button, a, input, .btn, .nav-btn, .filter-btn, .view-btn, .segment-item, .segment-group-header, .platform-tab { transition: all 0.2s ease-out; }
        
        /* Focus states for keyboard navigation */
        :focus { outline: none; }
        :focus-visible { outline: 2px solid var(--accent-red); outline-offset: 2px; }
        button:focus-visible, a:focus-visible, input:focus-visible, [tabindex]:focus-visible { box-shadow: 0 0 0 3px rgba(227, 30, 36, 0.25); }
        
        /* Reduced motion for accessibility */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after { animation-duration: 0.01ms !important; animation-iteration-count: 1 !important; transition-duration: 0.01ms !important; scroll-behavior: auto !important; }
            .bg-grid { display: none; }
        }
        
        /* Prevent text selection on UI elements */
        button, .btn, .nav-btn, .filter-btn, .view-btn, .segment-item, .tier-badge { user-select: none; -webkit-user-select: none; }
        
        /* Improved hover states */
        .nav-btn:hover, .btn:hover, .filter-btn:hover { transform: translateY(-1px); }
        .btn:active, .nav-btn:active, .filter-btn:active { transform: translateY(0); }
        
        /* Icon styles */
        .icon { display: inline-flex; align-items: center; justify-content: center; width: 1em; height: 1em; vertical-align: middle; }
        .icon svg { width: 100%; height: 100%; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
        
        /* === TOAST NOTIFICATION SYSTEM === */
        .toast-container { position: fixed; bottom: 24px; right: 24px; z-index: 10000; display: flex; flex-direction: column; gap: 12px; pointer-events: none; }
        .toast { pointer-events: auto; padding: 14px 20px; background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 12px; display: flex; align-items: center; gap: 12px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4); transform: translateX(120%); opacity: 0; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); max-width: 380px; }
        .toast.visible { transform: translateX(0); opacity: 1; }
        .toast.hiding { transform: translateX(120%); opacity: 0; }
        .toast-success { border-left: 4px solid var(--accent-green); }
        .toast-error { border-left: 4px solid var(--accent-red); }
        .toast-info { border-left: 4px solid var(--accent-blue); }
        .toast-warning { border-left: 4px solid var(--accent-yellow); }
        .toast-icon { width: 20px; height: 20px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .toast-success .toast-icon { background: rgba(16, 185, 129, 0.2); color: var(--accent-green); }
        .toast-error .toast-icon { background: rgba(227, 30, 36, 0.2); color: var(--accent-red); }
        .toast-info .toast-icon { background: rgba(0, 212, 255, 0.2); color: var(--accent-blue); }
        .toast-message { font-size: 12px; color: var(--text-secondary); }
        .toast-close { background: none; border: none; color: var(--text-secondary); cursor: pointer; padding: 4px; border-radius: 4px; }
        .toast-close:hover { background: rgba(255,255,255,0.1); }
        .toast-progress { position: absolute; bottom: 0; left: 0; height: 3px; background: var(--accent-green); border-radius: 0 0 0 12px; animation: toast-progress linear forwards; }
        .toast-error .toast-progress { background: var(--accent-red); }
        @keyframes toast-progress { from { width: 100%; } to { width: 0%; } }
        
        /* === LOADING BUTTON STATES === */
        .btn-loading { position: relative; pointer-events: none; opacity: 0.7; }
        .btn-loading .btn-text { opacity: 0; }
        .btn-loading .btn-spinner { display: flex; }
        .btn-spinner { display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }
        .btn-spinner svg { animation: spin 1s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        button:disabled, .btn:disabled { opacity: 0.6; cursor: not-allowed; pointer-events: none; }
    </style>
</head>
<body>
    <div class="bg-grid"></div>
    <header class="header">
        <div class="header-left">
            <div class="logo">
                <div class="logo-icon">
                    <svg viewBox="0 0 44 44" fill="none">
                        <!-- Rings -->
                        <circle class="globe-outer" cx="22" cy="22" r="19" stroke="url(#atlasGradPO)" stroke-width="1.25" fill="none"/>
                        <circle class="globe-mid" cx="22" cy="22" r="13" stroke="url(#atlasGradPO)" stroke-width="1" fill="none" opacity="0.7"/>
                        <circle class="globe-inner" cx="22" cy="22" r="7" stroke="url(#atlasGradPO)" stroke-width="0.75" fill="none" opacity="0.5"/>
                        <!-- Lat/Long -->
                        <ellipse class="globe-lat" cx="22" cy="22" rx="19" ry="7" stroke="url(#atlasGradPO)" stroke-width="0.5" fill="none" opacity="0.4"/>
                        <ellipse class="globe-long" cx="22" cy="22" rx="7" ry="19" stroke="url(#atlasGradPO)" stroke-width="0.5" fill="none" opacity="0.4"/>
                        <!-- Center -->
                        <circle class="globe-center" cx="22" cy="22" r="2.5" fill="url(#atlasGradPO)"/>
                        <!-- Cardinal points -->
                        <g class="cardinal-points">
                            <circle class="cardinal-point" cx="22" cy="3" r="1.5" fill="#00d4ff"/>
                            <circle class="cardinal-point" cx="41" cy="22" r="1.5" fill="#7c3aed"/>
                            <circle class="cardinal-point" cx="22" cy="41" r="1.5" fill="#14b8a6"/>
                            <circle class="cardinal-point" cx="3" cy="22" r="1.5" fill="#00d4ff"/>
                        </g>
                        <!-- Segment points -->
                        <circle class="seg-1" cx="33" cy="9" r="1.2" fill="#ec4899"/>
                        <circle class="seg-2" cx="36" cy="30" r="1.2" fill="#f59e0b"/>
                        <circle class="seg-3" cx="11" cy="35" r="1.2" fill="#10b981"/>
                        <circle class="seg-4" cx="8" cy="14" r="1.2" fill="#8b5cf6"/>
                        <defs><linearGradient id="atlasGradPO" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#00d4ff"/><stop offset="50%" stop-color="#7c3aed"/><stop offset="100%" stop-color="#14b8a6"/></linearGradient></defs>
                    </svg>
                </div>
                <div class="logo-text">
                    <span class="brand">A.T.L.A.S</span>
                    <span class="tagline">Audience Targeting & Layered Analysis System</span>
                    <div class="powered-by">
                        <span>powered by</span>
                        <svg viewBox="0 0 20 20" width="9" height="9"><circle cx="7" cy="10" r="5" fill="none" stroke="#E91E8C" stroke-width="1.5"/><circle cx="13" cy="10" r="5" fill="none" stroke="#7B2D8E" stroke-width="1.5"/></svg>
                        <span class="growity-name">Growity AI Studio</span>
                    </div>
                </div>
            </div>
            <div class="po-badge">
                <div class="po-icon">PO</div>
                <span class="po-text">Premium Market</span>
            </div>
            <a href="segment-page.html" class="nav-btn">‚Üê K√ºt√ºphane</a>
            <a href="segmentation-quadrant.html" class="nav-btn">Quadrant</a>
        </div>
        <div class="header-actions">
            <!-- Pre-Segments Dropdown -->
            <div class="pre-segments-dropdown" id="preSegmentsDropdown">
                <button class="pre-segments-btn" onclick="togglePreSegments()" aria-label="Pre-Segments Men√ºs√º">
                    <span class="icon"><svg viewBox="0 0 24 24"><path d="M3 3h7v7H3zM14 3h7v7h-7zM14 14h7v7h-7zM3 14h7v7H3z"/></svg></span>
                    Pre-Segments
                    <span class="dropdown-arrow" id="preSegmentsArrow">‚ñº</span>
                </button>
                <div class="pre-segments-menu" id="preSegmentsMenu">
                    <div class="pre-segments-group">
                        <div class="pre-segments-group-title">
                            <span class="icon" style="color: #ffc107;"><svg viewBox="0 0 24 24" width="14" height="14"><path d="M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z"/></svg></span>
                            Enerjisa
                        </div>
                        <a href="enerjisa-30yil.html" class="pre-segments-item enerjisa">
                            <span>üéâ</span> 30. Yƒ±l
                        </a>
                    </div>
                </div>
            </div>
            <button class="btn btn-secondary" onclick="exportPNG()" aria-label="PNG olarak indir"><span class="icon"><svg viewBox="0 0 24 24"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></svg></span> PNG</button>
            <button class="btn btn-secondary" onclick="exportExcel()" aria-label="Excel olarak indir"><span class="icon"><svg viewBox="0 0 24 24"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><path d="M8 13h2"/><path d="M14 13h2"/><path d="M8 17h2"/><path d="M14 17h2"/></svg></span> Excel</button>
        </div>
    </header>
    <div class="main-wrapper">
        <div class="top-section">
            <div class="left-panel">
                <div class="panel-header">
                    <div class="panel-title">40 Segment</div>
                    <div class="filter-row">
                        <button class="filter-btn active" data-tier="all" onclick="filterTier('all')">T√ºm√º</button>
                        <button class="filter-btn" data-tier="super" onclick="filterTier('super')" aria-label="S√ºper tier filtrele"><svg viewBox="0 0 24 24" width="12" height="12" fill="#ffd700" stroke="#ffd700" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></button>
                        <button class="filter-btn" data-tier="t1" onclick="filterTier('t1')">T1</button>
                        <button class="filter-btn" data-tier="t2" onclick="filterTier('t2')">T2</button>
                        <button class="filter-btn" data-tier="t3" onclick="filterTier('t3')">T3</button>
                        <button class="filter-btn" data-tier="t4" onclick="filterTier('t4')">T4</button>
                    </div>
                </div>
                <div class="segment-list" id="segmentList"></div>
            </div>
            <div class="center-panel">
                <div class="canvas-header">
                    <div class="canvas-title">Segment Quadrant</div>
                    <div class="view-toggle">
                        <button class="view-btn active" onclick="setView('all')">T√ºm√º</button>
                        <button class="view-btn" onclick="setView('Aile Seyahat Planlayƒ±cƒ±larƒ±')">Aile</button>
                        <button class="view-btn" onclick="setView('Deneyim Odaklƒ± ≈ûehirli Premiumlar')">Urban</button>
                        <button class="view-btn" onclick="setView('Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler')">Deƒüer</button>
                        <button class="view-btn" onclick="setView('Eri≈üilebilir Premium T√ºketiciler')">Premium</button>
                    </div>
                </div>
                <div class="canvas-wrap"><canvas id="quadrantCanvas"></canvas></div>
            </div>
            <div class="right-panel">
                <div id="emptyState" class="empty-state">
                    <div class="empty-icon">üëÜ</div>
                    <div style="font-size:12px;color:var(--text-secondary);">Segment Se√ßin</div>
                    <div style="font-size:10px;color:var(--text-secondary);margin-top:6px;">Detaylarƒ± g√∂rmek i√ßin bir segment tƒ±klayƒ±n</div>
                </div>
                <div id="detailPanel" style="display:none;">
                    <div class="detail-section">
                        <div class="detail-header">
                            <div class="tier-badge" id="detailTier">T1</div>
                            <div>
                                <div class="detail-name" id="detailName">Segment</div>
                                <div class="detail-parent" id="detailParent">Parent</div>
                            </div>
                        </div>
                    </div>
                    <div class="detail-section">
                        <div class="detail-title">Metrikler</div>
                        <div class="metrics-grid">
                            <div class="metric-box"><div class="metric-value" id="metricX">50</div><div class="metric-label" id="metricXLabel">X</div></div>
                            <div class="metric-box"><div class="metric-value" id="metricY">50</div><div class="metric-label" id="metricYLabel">Y</div></div>
                            <div class="metric-box"><div class="metric-value" id="metricSize">50</div><div class="metric-label" id="metricSizeLabel">Boyut</div></div>
                            <div class="metric-box"><div class="metric-value" id="metricTier">T1</div><div class="metric-label">√ñncelik</div></div>
                        </div>
                    </div>
                    <div class="detail-section">
                        <div class="detail-title">Strateji √ñnerisi</div>
                        <div class="strategy-card">
                            <div class="strategy-title" id="strategyTitle">Kampanya Stratejisi</div>
                            <div class="strategy-text" id="strategyText">Strateji a√ßƒ±klamasƒ± burada g√∂r√ºnecek.</div>
                            <div class="strategy-reason" id="strategyReason">Neden bu strateji?</div>
                            <div class="strategy-tags" id="strategyTags"></div>
                        </div>
                    </div>
                    <div class="detail-section">
                        <div class="detail-title">Platform Ula≈üƒ±labilirlik</div>
                        <div class="platform-reach-section">
                            <div class="reach-bars" id="reachBars"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="bottom-panel" id="bottomPanel">
            <div class="bottom-content">
                <div class="bottom-header">
                    <div class="bottom-title">
                        <span id="bottomSegName">Segment</span>
                        <span class="bottom-subtitle" id="bottomSegParent"></span>
                    </div>
                    <button class="close-btn" onclick="closeBottomPanel()">‚úï</button>
                </div>
                <div class="bottom-grid">
                    <div class="bht-impact-section">
                        <div class="bht-impact-title">Tahmini BHT Etki Analizi</div>
                        <div class="bht-category">
                            <div class="bht-category-header awareness"><span>Awareness</span><span class="bht-impact-value" id="awImpact">+12%</span></div>
                            <div class="bht-questions-list" id="awQuestions"></div>
                        </div>
                        <div class="bht-category">
                            <div class="bht-category-header consideration"><span>Consideration</span><span class="bht-impact-value" id="coImpact">+8%</span></div>
                            <div class="bht-questions-list" id="coQuestions"></div>
                        </div>
                        <div class="bht-category">
                            <div class="bht-category-header conversion"><span>Conversion</span><span class="bht-impact-value" id="cvImpact">+5%</span></div>
                            <div class="bht-questions-list" id="cvQuestions"></div>
                        </div>
                    </div>
                    <div class="platform-section">
                        <div class="bht-impact-title">Platform Hedefleme √ñnerileri</div>
                        <div class="platform-grid">
                            <div class="platform-card"><div class="platform-header meta">Meta</div><div class="platform-body" id="metaTargeting"></div></div>
                            <div class="platform-card"><div class="platform-header x">X</div><div class="platform-body" id="xTargeting"></div></div>
                            <div class="platform-card"><div class="platform-header tiktok">TikTok</div><div class="platform-body" id="tiktokTargeting"></div></div>
                            <div class="platform-card"><div class="platform-header youtube">YouTube</div><div class="platform-body" id="youtubeTargeting"></div></div>
                            <div class="platform-card"><div class="platform-header dv360">DV360</div><div class="platform-body" id="dv360Targeting"></div></div>
                        </div>
                        <div class="extra-targeting-grid">
                            <div class="extra-targeting-card"><div class="extra-targeting-header">Lifestyle Segments</div><div class="extra-targeting-body" id="lifestyleTargeting"></div></div>
                            <div class="extra-targeting-card"><div class="extra-targeting-header">Affinity Audiences</div><div class="extra-targeting-body" id="affinityTargeting"></div></div>
                            <div class="extra-targeting-card"><div class="extra-targeting-header">In-Market Segments</div><div class="extra-targeting-body" id="inmarketTargeting"></div></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="tooltip" id="tooltip"></div>
    <script>
        const bhtQ = {
            awareness: [
                { id: 'aw1', text: '"Premium Market" konseptini duydum', isNew: true, impact: 15 },
                { id: 'aw2', text: 'PO market hizmeti sunuyor biliyorum', isNew: true, impact: 12 },
                { id: 'aw3', text: 'Kaliteli atƒ±≈ütƒ±rmalƒ±k bulabilirim', isNew: true, impact: 10 },
                { id: 'aw4', text: 'G√ºvenilir bir marka', isNew: false, impact: 5 },
                { id: 'aw5', text: 'Modern ve yenilik√ßi', isNew: false, impact: 8 },
                { id: 'aw6', text: 'Lider marka', isNew: false, impact: 4 }
            ],
            consideration: [
                { id: 'co1', text: 'Yol √ºst√º atƒ±≈ütƒ±rmalƒ±k i√ßin tercih', isNew: true, impact: 12 },
                { id: 'co2', text: 'Premium √ºr√ºnler bulabilirim', isNew: true, impact: 10 },
                { id: 'co3', text: 'Hƒ±zlƒ± kahve i√ßin uƒürarƒ±m', isNew: true, impact: 14 },
                { id: 'co4', text: 'Diƒüer istasyonlardan daha iyi', isNew: true, impact: 8 },
                { id: 'co5', text: 'M√º≈üterisini anlar', isNew: false, impact: 5 },
                { id: 'co6', text: 'ƒ∞stasyonlarƒ± aydƒ±nlƒ±k ve g√ºvenli', isNew: false, impact: 6 },
                { id: 'co7', text: 'Teknolojik √ß√∂z√ºmler sunar', isNew: false, impact: 7 },
                { id: 'co8', text: 'ƒ∞≈üimi hƒ±zlƒ± halledebilirim', isNew: false, impact: 9 }
            ],
            conversion: [
                { id: 'cv1', text: 'Son 1 ayda alƒ±≈üveri≈ü yaptƒ±m', isNew: true, impact: 18 },
                { id: 'cv2', text: 'Sadece market i√ßin gittim', isNew: true, impact: 20 },
                { id: 'cv3', text: 'Tavsiye ederim', isNew: true, impact: 15 },
                { id: 'cv4', text: '√úr√ºnler beklentimi kar≈üƒ±ladƒ±', isNew: true, impact: 12 },
                { id: 'cv5', text: 'Yolumu deƒüi≈ütiririm', isNew: false, impact: 10 },
                { id: 'cv6', text: 'Olmasa eksikliƒüini hissederim', isNew: false, impact: 8 }
            ]
        };
        const segBhtRec = {
            'Aile Seyahat Planlayƒ±cƒ±larƒ±': ['aw2', 'aw3', 'co1', 'co3', 'cv1'],
            'Deneyim Odaklƒ± ≈ûehirli Premiumlar': ['aw1', 'aw5', 'co2', 'co4', 'cv4'],
            'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler': ['aw3', 'co1', 'co8', 'cv1', 'cv2'],
            'Eri≈üilebilir Premium T√ºketiciler': ['aw1', 'aw3', 'co2', 'co3', 'co4', 'cv1', 'cv3', 'cv4']
        };
        const targetT = {
            'Aile Seyahat Planlayƒ±cƒ±larƒ±': {
                meta: [{ type: 'Interest', target: 'Seyahat, Aile tatili', bht: 'aw' }, { type: 'Behavior', target: 'Sƒ±k seyahat edenler', bht: 'co' }, { type: 'Custom', target: 'PO app users', bht: 'cv' }],
                x: [{ type: 'Trend', target: '#HaftaSonuKa√ßamaƒüƒ±', bht: 'aw' }, { type: 'Keyword', target: 'tatil, yolculuk', bht: 'co' }],
                tiktok: [{ type: 'Hashtag', target: '#aileiletatil', bht: 'aw' }, { type: 'Creator', target: 'Aile influencer', bht: 'co' }],
                youtube: [{ type: 'Affinity', target: 'Travel Buffs', bht: 'aw' }, { type: 'In-Market', target: 'Family Vacations', bht: 'co' }],
                dv360: [{ type: 'Affinity', target: 'Travel Buffs', bht: 'aw' }, { type: 'In-Market', target: 'Auto Fuel', bht: 'co' }],
                reach: { meta: 78, youtube: 65, tiktok: 45, x: 32, dv360: 72 },
                lifestyle: ['Family-First Planners', 'Weekend Adventurers', 'Road Trip Enthusiasts', 'Budget-Conscious Families'],
                affinity: ['Travel Buffs', 'Family-Focused', 'Outdoor Enthusiasts', 'Auto Enthusiasts'],
                inmarket: ['Family Vacations', 'Auto Fuel & Charging', 'Camping Gear', 'Road Trip Essentials']
            },
            'Deneyim Odaklƒ± ≈ûehirli Premiumlar': {
                meta: [{ type: 'Interest', target: 'Wellness, Fitness', bht: 'aw' }, { type: 'Behavior', target: 'Health conscious', bht: 'co' }, { type: 'LAL', target: 'Premium %1-2', bht: 'cv' }],
                x: [{ type: 'Trend', target: '#PremiumAnlar', bht: 'aw' }, { type: 'Keyword', target: 'kahve, wellness', bht: 'co' }],
                tiktok: [{ type: 'Hashtag', target: '#wellness', bht: 'aw' }, { type: 'Creator', target: 'Lifestyle creators', bht: 'co' }],
                youtube: [{ type: 'Affinity', target: 'Health & Fitness', bht: 'aw' }, { type: 'In-Market', target: 'Health Food', bht: 'co' }],
                dv360: [{ type: 'Affinity', target: 'Coffee Shop Regulars', bht: 'aw' }, { type: 'In-Market', target: 'Organic Products', bht: 'co' }],
                reach: { meta: 82, youtube: 58, tiktok: 62, x: 48, dv360: 68 },
                lifestyle: ['Urban Wellness Seekers', 'Premium Experience Hunters', 'Health-Conscious Pros', 'Mindful Consumers'],
                affinity: ['Health & Fitness Buffs', 'Coffee Shop Regulars', 'Foodies', 'Green Living Enthusiasts'],
                inmarket: ['Health Food', 'Premium Beverages', 'Organic Products', 'Specialty Coffee']
            },
            'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler': {
                meta: [{ type: 'Interest', target: 'Fƒ±rsatlar, ƒ∞ndirimler', bht: 'aw' }, { type: 'Behavior', target: 'Deal seekers', bht: 'co' }, { type: 'Custom', target: 'Sadakat √ºyeleri', bht: 'cv' }],
                x: [{ type: 'Trend', target: '#FlashFƒ±rsat', bht: 'aw' }, { type: 'Keyword', target: 'indirim, kampanya', bht: 'co' }],
                tiktok: [{ type: 'Hashtag', target: '#indirim #fƒ±rsat', bht: 'aw' }, { type: 'Creator', target: 'Fƒ±rsat creators', bht: 'co' }],
                youtube: [{ type: 'Affinity', target: 'Bargain Hunters', bht: 'aw' }, { type: 'In-Market', target: 'Coupons', bht: 'co' }],
                dv360: [{ type: 'Affinity', target: 'Value Shoppers', bht: 'aw' }, { type: 'In-Market', target: 'Convenience Stores', bht: 'co' }],
                reach: { meta: 85, youtube: 72, tiktok: 55, x: 28, dv360: 78 },
                lifestyle: ['Smart Shoppers', 'Deal Hunters', 'Price-Conscious Families', 'Loyalty Program Fans'],
                affinity: ['Bargain Hunters', 'Value Shoppers', 'Coupon Savers', 'Fast Food Lovers'],
                inmarket: ['Coupons & Discounts', 'Convenience Stores', 'Grocery Deals', 'Loyalty Programs']
            },
            'Eri≈üilebilir Premium T√ºketiciler': {
                meta: [{ type: 'Interest', target: 'Self-care, Premium kahve', bht: 'aw' }, { type: 'Behavior', target: 'Impulse buyers', bht: 'co' }, { type: 'LAL', target: 'Premium alƒ±cƒ±lar %1-3', bht: 'cv' }],
                x: [{ type: 'Trend', target: '#Kendine√ñd√ºl', bht: 'aw' }, { type: 'Keyword', target: 'kahve keyfi, mola', bht: 'co' }],
                tiktok: [{ type: 'Hashtag', target: '#kendini≈üƒ±mart', bht: 'aw' }, { type: 'Creator', target: 'Kahve creators', bht: 'co' }],
                youtube: [{ type: 'Affinity', target: 'Coffee Shop Regulars', bht: 'aw' }, { type: 'In-Market', target: 'Premium Snacks', bht: 'co' }],
                dv360: [{ type: 'Affinity', target: 'Foodies', bht: 'aw' }, { type: 'In-Market', target: 'Convenience Stores', bht: 'co' }],
                reach: { meta: 88, youtube: 62, tiktok: 68, x: 38, dv360: 75 },
                lifestyle: ['Self-Reward Seekers', 'Convenience Premium Buyers', 'Daily Upgraders', 'Impulse Treat Lovers'],
                affinity: ['Coffee Shop Regulars', 'Foodies', 'Fast Food Cravers', 'Snack Enthusiasts'],
                inmarket: ['Premium Coffee', 'Snack Foods', 'Convenience Stores', 'Quick Service Restaurants']
            }
        };
        const strategyData = {
            'Hafta Sonu Ka√ßamak√ßƒ±larƒ±': { title: 'Hafta Sonu Paketi Combo', text: 'Her hafta sonu d√ºzenli yola √ßƒ±kan bu kitle i√ßin "Hafta Sonu Ka√ßamak Paketi" olu≈üturun. Kahve + sandvi√ß + atƒ±≈ütƒ±rmalƒ±k combo, Cuma-Pazar √∂zel fiyat. Lokasyon bazlƒ± push notification.', reason: 'Y√ºksek frekans (haftalƒ±k) ve d√ºzenli rota = tahmin edilebilir davranƒ±≈ü. Combo teklifleri sepet ortalamasƒ±nƒ± %35 artƒ±rƒ±r.', tags: ['Combo Deal', 'Weekend Push', 'Location-Based', 'High Frequency'] },
            'Aile Yol Gezisi Tutkunlarƒ±': { title: 'Yol Arkada≈üƒ± Aile Seti', text: 'Uzun yolculuklarda √ßoklu mola = √ßoklu satƒ±≈ü fƒ±rsatƒ±. "Yol Arkada≈üƒ± Aile Seti" ile √ßocuklara √∂zel atƒ±≈ütƒ±rmalƒ±k, ebeveynlere kahve. Rota √ºzerindeki t√ºm PO\'larda ge√ßerli puan sistemi.', reason: 'Uzun yol = 3-4 mola = 3-4x satƒ±≈ü potansiyeli. Aile boyutu sepet deƒüerini 2.5x artƒ±rƒ±r.', tags: ['Family Pack', 'Multi-Stop', 'Loyalty Points', 'Road Trip'] },
            'G√ºvenlik √ñncelikli Maceracƒ±lar': { title: 'Premium Kalite G√ºvencesi', text: 'G√ºvenlik ve kalite √∂ncelikli segment i√ßin √ºr√ºn men≈üei, kalite sertifikalarƒ± ve hijyen standartlarƒ±nƒ± √∂n plana √ßƒ±karƒ±n. "Premium Market Kalite Garantisi" sertifikasƒ±.', reason: 'Premium √∂deme kapasitesi y√ºksek, fiyat hassasiyeti d√º≈ü√ºk. G√ºven = sadakat = CLV artƒ±≈üƒ±.', tags: ['Quality Seal', 'Trust Building', 'Premium Pricing', 'Cross-Sell'] },
            '≈ûehirli Wellness Arayanlar': { title: 'G√ºnl√ºk Wellness Rit√ºeli', text: 'Sabah rutinine entegre: Protein bar + cold-press juice + specialty coffee "Wellness Start" paketi. G√ºnl√ºk alƒ±≈ükanlƒ±k i√ßin subscription modeli. ƒ∞stasyonlarda "Wellness Corner".', reason: 'G√ºnl√ºk rit√ºel = g√ºnl√ºk gelir. Wellness trendi = premium fiyatlama. Subscription LTV\'yi 4x artƒ±rƒ±r.', tags: ['Daily Ritual', 'Subscription', 'Wellness Corner', 'Morning Routine'] },
            'Premium Teknoloji √ñnc√ºleri': { title: 'Grab & Go Premium Experience', text: 'Hƒ±z + kalite dengesi kritik. Mobile pre-order ile sƒ±fƒ±r bekleme, √∂deme entegrasyonu, ki≈üiselle≈ütirilmi≈ü sipari≈ü ge√ßmi≈üi. Specialty coffee + premium snack pairing √∂nerileri app √ºzerinden.', reason: 'Zaman = para bu segment i√ßin. Teknoloji adaptasyonu y√ºksek, mobile conversion %40+ beklenir.', tags: ['Mobile First', 'Pre-Order', 'Zero Wait', 'Personalization'] },
            'Flash ƒ∞ndirim Tutkunlarƒ±': { title: 'Flash Deal Notification', text: 'Anlƒ±k karar vericiler i√ßin real-time flash deal sistemi. Stok fazlasƒ± √ºr√ºnlerde %50+ indirim, 2 saatlik pencere, push notification. Gamification: "ƒ∞lk 50 ki≈üiye ekstra indirim".', reason: 'D√ºrt√ºsel satƒ±n alma = y√ºksek conversion hƒ±zƒ±. Flash deal\'lar dead stock maliyetini minimize eder.', tags: ['Flash Sale', 'Push Notification', 'Gamification', 'FOMO'] },
            'Puan & √ñd√ºl Koleksiyoncularƒ±': { title: 'Sadakat Puan √áarpanƒ±', text: 'Sadakat programƒ±nƒ± g√º√ßlendirin: Premium Market alƒ±≈üveri≈ülerinde 2x puan, √∂zel g√ºnlerde 5x puan, referral bonus. Puan = Premium Market √ºr√ºn indirimi. VIP tier sistemi.', reason: 'Program sadakati = marka sadakati. 2x puan kampanyalarƒ± traffic %65 artƒ±rƒ±r. VIP\'ler 3x fazla harcar.', tags: ['2x Points', 'VIP Tiers', 'Referral Bonus', 'Loyalty Loop'] },
            'Kolaylƒ±k Premium Arayanlar': { title: '2 Dakika Garantisi', text: 'S√ºper segment! "2 Dakika Garantisi" ile giri≈ü-√ßƒ±kƒ±≈ü s√ºresini taahh√ºt edin. Express kasa, hazƒ±r paketler, pre-order pick-up noktasƒ±. Hƒ±z + kalite vaadini vurgulayƒ±n.', reason: 'Bi√ßilmi≈ü kaftan: Hƒ±z istiyorlar, premium √∂d√ºyorlar. En y√ºksek LTV ve en d√º≈ü√ºk churn riski.', tags: ['Speed Guarantee', 'Express Lane', 'Pre-Order', 'Premium Experience'] },
            'Kendine √ñd√ºl Verenler': { title: 'Bug√ºn Senin G√ºn√ºn', text: '"Bunu hak ettim" anƒ±nƒ± yakalayƒ±n. √ñƒüle molasƒ±, i≈ü √ßƒ±kƒ±≈üƒ± gibi reward moment\'larda hedefe y√∂nelik mesaj. Premium treat\'lerde "Kendine √ñd√ºl" etiketi. Packaging\'de motivasyonel mesaj.', reason: 'Duygusal satƒ±n alma = premium pricing acceptance. Doƒüru zamanlama ile conversion %80+ m√ºmk√ºn.', tags: ['Reward Moment', 'Emotional Trigger', 'Premium Treat', 'Self-Care'] },
            'G√ºnl√ºk Premium Y√ºkseltmeciler': { title: 'Upgrade Your Day', text: 'Her g√ºn bir upgrade: Normal kahve yerine specialty, standart sandvi√ß yerine gourmet. "+5‚Ç∫ ile Premium" upsell t√ºm √ºr√ºnlerde. G√ºnl√ºk upgrade streak\'leri i√ßin badge sistemi.', reason: 'K√º√ß√ºk upgrade\'ler b√ºy√ºk marjlar. +5‚Ç∫ upsell kabul oranƒ± %45, margin artƒ±≈üƒ± 3x.', tags: ['Daily Upgrade', '+5‚Ç∫ Upsell', 'Streak Rewards', 'Premium Swap'] }
        };
        const defaultStrategy = { title: 'Segment Stratejisi', text: 'Bu segment i√ßin √∂zelle≈ütirilmi≈ü kampanya stratejisi geli≈ütirin. Segmentin temel motivasyonlarƒ±nƒ± ve davranƒ±≈ü kalƒ±plarƒ±nƒ± analiz ederek hedefe y√∂nelik mesajla≈üma olu≈üturun.', reason: 'Segment karakteristiƒüine uygun strateji ile conversion oranlarƒ±nƒ± artƒ±rƒ±n.', tags: ['Targeted', 'Data-Driven'] };
        const segments = [
            { parent: 'Aile Seyahat Planlayƒ±cƒ±larƒ±', name: 'Hafta Sonu Ka√ßamak√ßƒ±larƒ±', x: 65, y: 90, size: 95, tier: 'T1' },
            { parent: 'Aile Seyahat Planlayƒ±cƒ±larƒ±', name: 'Aile Yol Gezisi Tutkunlarƒ±', x: 55, y: 70, size: 90, tier: 'T1' },
            { parent: 'Aile Seyahat Planlayƒ±cƒ±larƒ±', name: 'G√ºvenlik √ñncelikli Maceracƒ±lar', x: 75, y: 65, size: 75, tier: 'T2' },
            { parent: 'Aile Seyahat Planlayƒ±cƒ±larƒ±', name: 'Tema Parkƒ± Meraklƒ±larƒ±', x: 45, y: 60, size: 70, tier: 'T2' },
            { parent: 'Aile Seyahat Planlayƒ±cƒ±larƒ±', name: 'Aile Kamp Planlayƒ±cƒ±larƒ±', x: 40, y: 55, size: 65, tier: 'T2' },
            { parent: 'Aile Seyahat Planlayƒ±cƒ±larƒ±', name: 'Sezonluk Tatilciler', x: 50, y: 25, size: 60, tier: 'T3' },
            { parent: 'Aile Seyahat Planlayƒ±cƒ±larƒ±', name: '√áok Ku≈üaklƒ± Planlayƒ±cƒ±lar', x: 60, y: 35, size: 55, tier: 'T3' },
            { parent: 'Aile Seyahat Planlayƒ±cƒ±larƒ±', name: 'Eƒüitici Gezi Arayanlar', x: 55, y: 30, size: 45, tier: 'T3' },
            { parent: 'Aile Seyahat Planlayƒ±cƒ±larƒ±', name: 'Seyahat Puanƒ± Optimizecileri', x: 30, y: 75, size: 50, tier: 'T4' },
            { parent: 'Aile Seyahat Planlayƒ±cƒ±larƒ±', name: 'B√ºt√ße Dostu Aile Tatilcileri', x: 20, y: 45, size: 55, tier: 'T4' },
            { parent: 'Deneyim Odaklƒ± ≈ûehirli Premiumlar', name: '≈ûehirli Wellness Arayanlar', x: 85, y: 70, size: 90, tier: 'T1' },
            { parent: 'Deneyim Odaklƒ± ≈ûehirli Premiumlar', name: 'Premium Teknoloji √ñnc√ºleri', x: 80, y: 75, size: 75, tier: 'T1' },
            { parent: 'Deneyim Odaklƒ± ≈ûehirli Premiumlar', name: 'L√ºks Macera Gezginleri', x: 75, y: 85, size: 65, tier: 'T2' },
            { parent: 'Deneyim Odaklƒ± ≈ûehirli Premiumlar', name: 'Premium Seyahat Ustalarƒ±', x: 70, y: 90, size: 55, tier: 'T2' },
            { parent: 'Deneyim Odaklƒ± ≈ûehirli Premiumlar', name: 'K√ºlt√ºrel Deneyim Koleksiyoncularƒ±', x: 50, y: 65, size: 55, tier: 'T2' },
            { parent: 'Deneyim Odaklƒ± ≈ûehirli Premiumlar', name: 'Fine Dining Tutkunlarƒ±', x: 45, y: 85, size: 50, tier: 'T3' },
            { parent: 'Deneyim Odaklƒ± ≈ûehirli Premiumlar', name: 'L√ºks Ya≈üam Tarzƒ± Meraklƒ±larƒ±', x: 55, y: 95, size: 45, tier: 'T3' },
            { parent: 'Deneyim Odaklƒ± ≈ûehirli Premiumlar', name: 'Butik Moda Takip√ßileri', x: 40, y: 70, size: 40, tier: 'T4' },
            { parent: 'Deneyim Odaklƒ± ≈ûehirli Premiumlar', name: 'Sanat & Tiyatro Hamileri', x: 35, y: 60, size: 45, tier: 'T4' },
            { parent: 'Deneyim Odaklƒ± ≈ûehirli Premiumlar', name: 'Yat & Country Club √úyeleri', x: 30, y: 95, size: 30, tier: 'T4' },
            { parent: 'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler', name: 'Flash ƒ∞ndirim Tutkunlarƒ±', x: 75, y: 90, size: 85, tier: 'T1' },
            { parent: 'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler', name: 'Puan & √ñd√ºl Koleksiyoncularƒ±', x: 55, y: 85, size: 80, tier: 'T1' },
            { parent: 'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler', name: 'Fƒ±rsat Avcƒ±sƒ± Alƒ±≈üveri≈ü√ßiler', x: 80, y: 75, size: 75, tier: 'T2' },
            { parent: 'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler', name: 'Sadece Temel ƒ∞htiya√ß Alƒ±cƒ±larƒ±', x: 60, y: 65, size: 75, tier: 'T2' },
            { parent: 'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler', name: 'ƒ∞ndirim Maksimizecileri', x: 85, y: 70, size: 70, tier: 'T2' },
            { parent: 'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler', name: 'Jenerik Marka Se√ßiciler', x: 90, y: 60, size: 65, tier: 'T3' },
            { parent: 'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler', name: 'ƒ∞ndirim K√∂≈üesi Gezginleri', x: 85, y: 45, size: 50, tier: 'T3' },
            { parent: 'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler', name: 'Toplu Alƒ±m Yapanlar', x: 70, y: 35, size: 55, tier: 'T4' },
            { parent: 'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler', name: 'Fiyat E≈üleme Talep Edenler', x: 95, y: 50, size: 45, tier: 'T4' },
            { parent: 'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler', name: 'ƒ∞kinci El Alƒ±≈üveri≈ü√ßiler', x: 80, y: 30, size: 35, tier: 'T4' },
            { parent: 'Eri≈üilebilir Premium T√ºketiciler', name: 'Kolaylƒ±k Premium Arayanlar', x: 90, y: 80, size: 95, tier: 'S√ºper' },
            { parent: 'Eri≈üilebilir Premium T√ºketiciler', name: 'Kendine √ñd√ºl Verenler', x: 95, y: 70, size: 90, tier: 'S√ºper' },
            { parent: 'Eri≈üilebilir Premium T√ºketiciler', name: 'G√ºnl√ºk Premium Y√ºkseltmeciler', x: 75, y: 75, size: 85, tier: 'T1' },
            { parent: 'Eri≈üilebilir Premium T√ºketiciler', name: 'Premium Kahve Tutkunlarƒ±', x: 70, y: 85, size: 85, tier: 'T1' },
            { parent: 'Eri≈üilebilir Premium T√ºketiciler', name: 'Son Dakika Premium √ñdeyiciler', x: 85, y: 75, size: 80, tier: 'T1' },
            { parent: 'Eri≈üilebilir Premium T√ºketiciler', name: 'Talep √úzerine Ya≈üam Tarzƒ±', x: 80, y: 70, size: 75, tier: 'T2' },
            { parent: 'Eri≈üilebilir Premium T√ºketiciler', name: 'Kalite Bilin√ßli D√ºrt√ºsel Alƒ±cƒ±lar', x: 85, y: 80, size: 70, tier: 'T2' },
            { parent: 'Eri≈üilebilir Premium T√ºketiciler', name: 'Organik & Doƒüal Se√ßiciler', x: 55, y: 85, size: 60, tier: 'T2' },
            { parent: 'Eri≈üilebilir Premium T√ºketiciler', name: 'Artisan √úr√ºn Destek√ßileri', x: 50, y: 90, size: 45, tier: 'T3' },
            { parent: 'Eri≈üilebilir Premium T√ºketiciler', name: 'Abonelik Servisi Benimseyenler', x: 40, y: 70, size: 55, tier: 'T4' }
        ];
        const parentColors = { 'Aile Seyahat Planlayƒ±cƒ±larƒ±': { bg: 'rgba(0,212,255,0.2)', border: '#00d4ff' }, 'Deneyim Odaklƒ± ≈ûehirli Premiumlar': { bg: 'rgba(124,58,237,0.2)', border: '#7c3aed' }, 'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler': { bg: 'rgba(255,107,53,0.2)', border: '#ff6b35' }, 'Eri≈üilebilir Premium T√ºketiciler': { bg: 'rgba(16,185,129,0.2)', border: '#10b981' } };
        const tierCfg = { 'S√ºper': { icon: '‚≠ê', class: 'tier-super' }, 'T1': { icon: 'T1', class: 'tier-t1' }, 'T2': { icon: 'T2', class: 'tier-t2' }, 'T3': { icon: 'T3', class: 'tier-t3' }, 'T4': { icon: 'T4', class: 'tier-t4' } };
        const axisL = { 'Aile Seyahat Planlayƒ±cƒ±larƒ±': { x: 'Premium A√ßƒ±klƒ±k', y: 'Frekans', s: 'Potansiyel' }, 'Deneyim Odaklƒ± ≈ûehirli Premiumlar': { x: 'Convenience', y: 'Premium Kapasite', s: 'Pazar' }, 'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler': { x: 'Fiyat Odaklƒ±lƒ±k', y: 'Alƒ±≈üveri≈ü Frekansƒ±', s: 'Hacim' }, 'Eri≈üilebilir Premium T√ºketiciler': { x: 'D√ºrt√ºsellik', y: 'Premium ƒ∞stek', s: 'Deƒüer' } };
        let canvas, ctx, selectedSeg = null, currentFilter = 'all', currentView = 'all';
        const pad = 55;
        function init() { canvas = document.getElementById('quadrantCanvas'); ctx = canvas.getContext('2d'); resizeCanvas(); window.addEventListener('resize', resizeCanvas); canvas.addEventListener('mousemove', handleMouseMove); canvas.addEventListener('click', handleClick); canvas.addEventListener('mouseleave', () => document.getElementById('tooltip').style.display = 'none'); renderSegmentList(); draw(); }
        function resizeCanvas() { const c = canvas.parentElement; canvas.width = c.clientWidth; canvas.height = c.clientHeight; draw(); }
        function renderSegmentList() { const groups = {}; segments.forEach((s, i) => { if (!groups[s.parent]) groups[s.parent] = []; groups[s.parent].push({ ...s, index: i }); }); const list = document.getElementById('segmentList'); list.innerHTML = ''; Object.entries(groups).forEach(([parent, segs]) => { const colors = parentColors[parent]; const div = document.createElement('div'); div.className = 'segment-group'; div.innerHTML = '<div class="segment-group-header" style="border-left-color:'+colors.border+';" onclick="toggleGroup(this)"><span>'+parent.split(' ').slice(0, 2).join(' ')+'</span><span>‚ñº</span></div><div class="segment-items open">'+segs.map(s => '<div class="segment-item '+(selectedSeg === s.index ? 'selected' : '')+'" onclick="selectSegment('+s.index+')"><div class="tier-badge '+tierCfg[s.tier].class+'">'+tierCfg[s.tier].icon+'</div><span>'+s.name+'</span></div>').join('')+'</div>'; list.appendChild(div); }); }
        function toggleGroup(h) { const i = h.nextElementSibling; i.classList.toggle('open'); h.querySelector('span:last-child').textContent = i.classList.contains('open') ? '‚ñº' : '‚ñ∂'; }
        function filterTier(tier) { currentFilter = tier; document.querySelectorAll('.filter-btn').forEach(b => b.classList.toggle('active', b.dataset.tier === tier)); draw(); const count = tier === 'all' ? segments.length : segments.filter(s => s.tier === tier).length; showToast(count + ' segment filtrelendi', 'info'); }
        function setView(view) { currentView = view; document.querySelectorAll('.view-btn').forEach(b => b.classList.toggle('active', b.textContent === (view === 'all' ? 'T√ºm√º' : view.split(' ')[0]))); draw(); }
        function getFiltered() { let f = segments; if (currentFilter !== 'all') { const m = { 'super': 'S√ºper', 't1': 'T1', 't2': 'T2', 't3': 'T3', 't4': 'T4' }; f = f.filter(s => s.tier === m[currentFilter]); } if (currentView !== 'all') f = f.filter(s => s.parent === currentView); return f; }
        function draw() { const w = canvas.width, h = canvas.height; ctx.fillStyle = '#0a0a0f'; ctx.fillRect(0, 0, w, h); const cw = w - pad * 2, ch = h - pad * 2, cx = pad + cw / 2, cy = pad + ch / 2; ctx.fillStyle = 'rgba(255,107,53,0.03)'; ctx.fillRect(pad, pad, cw / 2, ch / 2); ctx.fillStyle = 'rgba(16,185,129,0.05)'; ctx.fillRect(cx, pad, cw / 2, ch / 2); ctx.fillStyle = 'rgba(239,68,68,0.03)'; ctx.fillRect(pad, cy, cw / 2, ch / 2); ctx.fillStyle = 'rgba(0,212,255,0.03)'; ctx.fillRect(cx, cy, cw / 2, ch / 2); ctx.strokeStyle = 'rgba(255,255,255,0.04)'; ctx.lineWidth = 1; for (let i = 0; i <= 10; i++) { ctx.beginPath(); ctx.moveTo(pad + (cw / 10) * i, pad); ctx.lineTo(pad + (cw / 10) * i, h - pad); ctx.stroke(); ctx.beginPath(); ctx.moveTo(pad, pad + (ch / 10) * i); ctx.lineTo(w - pad, pad + (ch / 10) * i); ctx.stroke(); } ctx.strokeStyle = 'rgba(255,255,255,0.15)'; ctx.lineWidth = 2; ctx.beginPath(); ctx.moveTo(cx, pad); ctx.lineTo(cx, h - pad); ctx.stroke(); ctx.beginPath(); ctx.moveTo(pad, cy); ctx.lineTo(w - pad, cy); ctx.stroke(); ctx.font = '10px Sora'; ctx.fillStyle = 'rgba(255,255,255,0.4)'; ctx.textAlign = 'center'; ctx.fillText('Planlƒ± & Lifestyle', pad + cw / 4, pad + 16); ctx.fillText('D√ºrt√ºsel & Lifestyle', cx + cw / 4, pad + 16); ctx.fillText('Planlƒ± & Fonksiyonel', pad + cw / 4, h - pad - 8); ctx.fillText('D√ºrt√ºsel & Fonksiyonel', cx + cw / 4, h - pad - 8); const filtered = getFiltered(); filtered.forEach(seg => { const ri = segments.indexOf(seg), x = pad + (seg.x / 100) * cw, y = pad + ((100 - seg.y) / 100) * ch, size = (seg.size / 100) * 24 + 8, colors = parentColors[seg.parent]; if (selectedSeg === ri) { ctx.beginPath(); ctx.arc(x, y, size + 6, 0, Math.PI * 2); ctx.fillStyle = colors.border + '40'; ctx.fill(); } ctx.beginPath(); ctx.arc(x, y, size, 0, Math.PI * 2); ctx.fillStyle = colors.bg; ctx.fill(); ctx.strokeStyle = colors.border; ctx.lineWidth = selectedSeg === ri ? 3 : 2; ctx.stroke(); ctx.fillStyle = tierCfg[seg.tier].class === 'tier-super' ? '#ffd700' : '#fff'; ctx.font = 'bold ' + (size > 18 ? 10 : 8) + 'px Space Mono'; ctx.textAlign = 'center'; ctx.textBaseline = 'middle'; ctx.fillText(tierCfg[seg.tier].icon, x, y); }); }
        function handleMouseMove(e) { const rect = canvas.getBoundingClientRect(), mx = e.clientX - rect.left, my = e.clientY - rect.top, cw = canvas.width - pad * 2, ch = canvas.height - pad * 2; let found = null; getFiltered().forEach(seg => { const x = pad + (seg.x / 100) * cw, y = pad + ((100 - seg.y) / 100) * ch, size = (seg.size / 100) * 24 + 8; if (Math.sqrt((mx - x) ** 2 + (my - y) ** 2) < size) found = seg; }); const tt = document.getElementById('tooltip'); if (found) { canvas.style.cursor = 'pointer'; const l = axisL[found.parent]; tt.innerHTML = '<div style="font-weight:600;">'+found.name+'</div><div style="color:var(--text-secondary);font-size:10px;margin:4px 0;">'+found.parent+'</div><div style="font-size:10px;">'+l.x+': <b style="color:var(--accent-red);">'+found.x+'</b> | '+l.y+': <b style="color:var(--accent-red);">'+found.y+'</b></div>'; tt.style.display = 'block'; tt.style.left = (e.clientX + 14) + 'px'; tt.style.top = (e.clientY + 14) + 'px'; } else { canvas.style.cursor = 'default'; tt.style.display = 'none'; } }
        function handleClick(e) { const rect = canvas.getBoundingClientRect(), mx = e.clientX - rect.left, my = e.clientY - rect.top, cw = canvas.width - pad * 2, ch = canvas.height - pad * 2; getFiltered().forEach((seg, fi) => { const ri = segments.indexOf(seg), x = pad + (seg.x / 100) * cw, y = pad + ((100 - seg.y) / 100) * ch, size = (seg.size / 100) * 24 + 8; if (Math.sqrt((mx - x) ** 2 + (my - y) ** 2) < size) selectSegment(ri); }); }
        function selectSegment(idx) { selectedSeg = idx; const seg = segments[idx], l = axisL[seg.parent]; document.getElementById('emptyState').style.display = 'none'; document.getElementById('detailPanel').style.display = 'block'; document.getElementById('detailTier').textContent = tierCfg[seg.tier].icon; document.getElementById('detailTier').className = 'tier-badge ' + tierCfg[seg.tier].class; document.getElementById('detailName').textContent = seg.name; document.getElementById('detailParent').textContent = seg.parent; document.getElementById('metricX').textContent = seg.x; document.getElementById('metricXLabel').textContent = l.x; document.getElementById('metricY').textContent = seg.y; document.getElementById('metricYLabel').textContent = l.y; document.getElementById('metricSize').textContent = seg.size; document.getElementById('metricSizeLabel').textContent = l.s; document.getElementById('metricTier').textContent = seg.tier; const strat = strategyData[seg.name] || defaultStrategy; document.getElementById('strategyTitle').textContent = strat.title; document.getElementById('strategyText').textContent = strat.text; document.getElementById('strategyReason').textContent = strat.reason; document.getElementById('strategyTags').innerHTML = strat.tags.map(t => '<span class="strategy-tag">' + t + '</span>').join(''); const t = targetT[seg.parent]; if (t && t.reach) { const platforms = ['meta', 'youtube', 'tiktok', 'x', 'dv360']; document.getElementById('reachBars').innerHTML = platforms.map(p => '<div class="reach-item"><span class="reach-platform">' + p.charAt(0).toUpperCase() + p.slice(1) + '</span><div class="reach-bar-wrap"><div class="reach-bar ' + p + '" style="width:' + t.reach[p] + '%"></div></div><span class="reach-value">' + t.reach[p] + '%</span></div>').join(''); } document.getElementById('bottomPanel').classList.add('active'); document.getElementById('bottomSegName').textContent = seg.name; document.getElementById('bottomSegParent').textContent = seg.parent; updateBhtPanel(seg.parent); updateTargetingPanel(seg.parent); renderSegmentList(); draw(); showToast(seg.name + ' se√ßildi ‚Ä¢ Tier ' + seg.tier, 'info'); }
        function updateBhtPanel(parent) { const rec = segBhtRec[parent] || []; let awImp = 0, coImp = 0, cvImp = 0; ['awareness', 'consideration', 'conversion'].forEach(cat => { const el = document.getElementById(cat === 'awareness' ? 'awQuestions' : cat === 'consideration' ? 'coQuestions' : 'cvQuestions'); el.innerHTML = bhtQ[cat].map(q => { const isRec = rec.includes(q.id); if (isRec) { if (cat === 'awareness') awImp += q.impact; else if (cat === 'consideration') coImp += q.impact; else cvImp += q.impact; } return '<div class="bht-question-item ' + (isRec ? 'recommended' : '') + '">' + q.text + '</div>'; }).join(''); }); document.getElementById('awImpact').textContent = '+' + awImp + '%'; document.getElementById('coImpact').textContent = '+' + coImp + '%'; document.getElementById('cvImpact').textContent = '+' + cvImp + '%'; }
        function updateTargetingPanel(parent) { const t = targetT[parent]; if (!t) return; ['meta', 'x', 'tiktok', 'youtube', 'dv360'].forEach(plat => { const el = document.getElementById(plat + 'Targeting'); el.innerHTML = (t[plat] || []).map(r => '<div class="targeting-row"><span class="targeting-type">' + r.type + '</span><span class="targeting-value">' + r.target + '<span class="bht-mini ' + r.bht + '">' + r.bht.toUpperCase() + '</span></span></div>').join(''); }); document.getElementById('lifestyleTargeting').innerHTML = (t.lifestyle || []).map(l => '<div class="extra-item"><div class="extra-item-icon lifestyle"></div><span>' + l + '</span></div>').join(''); document.getElementById('affinityTargeting').innerHTML = (t.affinity || []).map(a => '<div class="extra-item"><div class="extra-item-icon affinity"></div><span>' + a + '</span></div>').join(''); document.getElementById('inmarketTargeting').innerHTML = (t.inmarket || []).map(i => '<div class="extra-item"><div class="extra-item-icon inmarket"></div><span>' + i + '</span></div>').join(''); }
        function exportPNG() { const btn = event.currentTarget; setButtonLoading(btn, true); setTimeout(() => { const link = document.createElement('a'); link.download = 'po-segment-quadrant.png'; link.href = canvas.toDataURL('image/png'); link.click(); showToast('PNG olarak indirildi', 'success'); setButtonLoading(btn, false); }, 400); }
        function closeBottomPanel() { document.getElementById('bottomPanel').classList.remove('active'); selectedSeg = null; renderSegmentList(); draw(); }
        function exportExcel() { const btn = event.currentTarget; setButtonLoading(btn, true); setTimeout(() => { let html = '<html><head><meta charset="UTF-8"></head><body><table border="1"><tr><th>Segment</th><th>Parent</th><th>X</th><th>Y</th><th>Size</th><th>Tier</th></tr>'; segments.forEach(s => { html += '<tr><td>' + s.name + '</td><td>' + s.parent + '</td><td>' + s.x + '</td><td>' + s.y + '</td><td>' + s.size + '</td><td>' + s.tier + '</td></tr>'; }); html += '</table></body></html>'; const blob = new Blob([html], { type: 'application/vnd.ms-excel' }); const link = document.createElement('a'); link.href = URL.createObjectURL(blob); link.download = 'po-segments.xls'; link.click(); showToast(segments.length + ' segment Excel olarak indirildi', 'success'); setButtonLoading(btn, false); }, 500); }
        
        // === LOADING BUTTON HELPER ===
        const spinnerSVG = '<svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10" opacity="0.25"/><path d="M12 2a10 10 0 0 1 10 10" stroke-linecap="round"/></svg>';
        function setButtonLoading(btn, isLoading) { if (!btn) return; if (isLoading) { btn.dataset.originalHtml = btn.innerHTML; btn.classList.add('btn-loading'); btn.disabled = true; btn.innerHTML = '<span class="btn-text">' + btn.innerHTML + '</span><span class="btn-spinner">' + spinnerSVG + '</span>'; } else { btn.classList.remove('btn-loading'); btn.disabled = false; if (btn.dataset.originalHtml) btn.innerHTML = btn.dataset.originalHtml; } }
        
        // === DEBOUNCE HELPER ===
        function debounce(func, wait) { let timeout; return function(...args) { clearTimeout(timeout); timeout = setTimeout(() => func.apply(this, args), wait); }; }
        
        // === TOAST NOTIFICATION SYSTEM ===
        (function() {
            var container = document.createElement('div');
            container.className = 'toast-container';
            document.body.appendChild(container);
            
            window.showToast = function(message, type, duration) {
                type = type || 'success';
                duration = duration || 4000;
                var icons = {
                    success: '<svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 6 9 17l-5-5"/></svg>',
                    error: '<svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>',
                    info: '<svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>'
                };
                var toast = document.createElement('div');
                toast.className = 'toast toast-' + type;
                toast.innerHTML = '<div class="toast-icon">' + icons[type] + '</div><div class="toast-content"><div class="toast-message">' + message + '</div></div><button class="toast-close" onclick="this.parentElement.remove()"><svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg></button><div class="toast-progress" style="animation-duration:' + duration + 'ms"></div>';
                container.appendChild(toast);
                requestAnimationFrame(function() { toast.classList.add('visible'); });
                setTimeout(function() { toast.classList.add('hiding'); toast.classList.remove('visible'); setTimeout(function() { toast.remove(); }, 300); }, duration);
            };
        })();
        
        // === PRE-SEGMENTS DROPDOWN ===
        function togglePreSegments() {
            const menu = document.getElementById('preSegmentsMenu');
            const arrow = document.getElementById('preSegmentsArrow');
            menu.classList.toggle('visible');
            arrow.classList.toggle('rotated');
        }
        
        // Click outside to close dropdown
        document.addEventListener('click', function(e) {
            const dropdown = document.getElementById('preSegmentsDropdown');
            if (dropdown && !dropdown.contains(e.target)) {
                document.getElementById('preSegmentsMenu').classList.remove('visible');
                document.getElementById('preSegmentsArrow').classList.remove('rotated');
            }
        });
        
        init();
    </script>
</body>
</html>
