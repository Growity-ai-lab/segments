<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Petrol Ofisi Premium Market - Segment Analizi</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); min-height: 100vh; color: #fff; }
        .header { background: rgba(255,255,255,0.03); border-bottom: 1px solid rgba(255,255,255,0.1); padding: 8px 14px; display: flex; justify-content: space-between; align-items: center; }
        .header-left { display: flex; align-items: center; gap: 10px; }
        .nav-btn { padding: 5px 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 5px; background: transparent; color: #fff; font-size: 10px; cursor: pointer; text-decoration: none; }
        .nav-btn:hover { background: rgba(255,255,255,0.1); }
        .logo { display: flex; align-items: center; gap: 6px; }
        .logo-icon { width: 26px; height: 26px; background: linear-gradient(135deg, #e31e24, #c41e24); border-radius: 4px; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 9px; }
        .logo-text { font-size: 13px; font-weight: 700; }
        .btn { padding: 5px 10px; border: none; border-radius: 4px; font-size: 9px; font-weight: 600; cursor: pointer; }
        .btn-secondary { background: rgba(255,255,255,0.1); color: #fff; }
        
        .main-wrapper { display: flex; flex-direction: column; height: calc(100vh - 44px); overflow: hidden; }
        .top-section { display: flex; flex: 1; min-height: 0; overflow: hidden; }
        
        .left-panel { width: 200px; background: rgba(255,255,255,0.02); border-right: 1px solid rgba(255,255,255,0.1); display: flex; flex-direction: column; }
        .panel-header { padding: 8px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .panel-title { font-size: 10px; font-weight: 600; }
        .filter-row { display: flex; gap: 2px; flex-wrap: wrap; margin-top: 5px; }
        .filter-btn { padding: 3px 5px; border: 1px solid rgba(255,255,255,0.15); border-radius: 3px; background: transparent; color: #aaa; font-size: 8px; cursor: pointer; }
        .filter-btn.active { background: rgba(227,30,36,0.2); border-color: #e31e24; color: #e31e24; }
        .segment-list { flex: 1; overflow-y: auto; padding: 4px; }
        .segment-group { margin-bottom: 3px; }
        .segment-group-header { display: flex; align-items: center; justify-content: space-between; padding: 4px 5px; background: rgba(255,255,255,0.05); border-radius: 3px; cursor: pointer; font-size: 8px; font-weight: 600; border-left: 2px solid #666; }
        .segment-items { max-height: 0; overflow: hidden; transition: max-height 0.3s; }
        .segment-items.open { max-height: 350px; }
        .segment-item { display: flex; align-items: center; gap: 4px; padding: 4px 5px; border-radius: 2px; cursor: pointer; margin-top: 1px; font-size: 8px; }
        .segment-item:hover { background: rgba(255,255,255,0.05); }
        .segment-item.selected { background: rgba(227,30,36,0.15); }
        .tier-badge { min-width: 16px; height: 12px; display: flex; align-items: center; justify-content: center; border-radius: 2px; font-size: 7px; font-weight: bold; }
        .tier-super { background: #ffd700; color: #000; }
        .tier-t1 { background: #4caf50; color: #fff; }
        .tier-t2 { background: #2196f3; color: #fff; }
        .tier-t3 { background: #ff9800; color: #fff; }
        .tier-t4 { background: #f44336; color: #fff; }
        
        .center-panel { flex: 1; display: flex; flex-direction: column; padding: 8px; min-width: 0; }
        .canvas-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; }
        .canvas-title { font-size: 11px; font-weight: 600; }
        .view-toggle { display: flex; background: rgba(255,255,255,0.1); border-radius: 3px; padding: 2px; }
        .view-btn { padding: 3px 6px; border: none; background: transparent; color: #888; font-size: 8px; cursor: pointer; border-radius: 2px; }
        .view-btn.active { background: rgba(227,30,36,0.3); color: #fff; }
        .canvas-wrap { flex: 1; background: rgba(255,255,255,0.02); border-radius: 6px; border: 1px solid rgba(255,255,255,0.1); position: relative; }
        #quadrantCanvas { width: 100%; height: 100%; }
        .tooltip { position: fixed; background: rgba(0,0,0,0.95); padding: 8px 10px; border-radius: 5px; font-size: 9px; pointer-events: none; z-index: 1000; display: none; max-width: 220px; }
        
        .right-panel { width: 260px; background: rgba(255,255,255,0.02); border-left: 1px solid rgba(255,255,255,0.1); display: flex; flex-direction: column; overflow-y: auto; }
        .detail-section { padding: 8px; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .detail-title { font-size: 8px; font-weight: 600; color: #888; text-transform: uppercase; margin-bottom: 5px; }
        .detail-header { display: flex; align-items: center; gap: 6px; }
        .detail-name { font-size: 11px; font-weight: 600; }
        .detail-parent { font-size: 8px; color: #888; }
        .metrics-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 3px; }
        .metric-box { background: rgba(255,255,255,0.03); border-radius: 3px; padding: 4px 2px; text-align: center; }
        .metric-value { font-size: 12px; font-weight: 700; color: #e31e24; }
        .metric-label { font-size: 6px; color: #888; }
        .info-text { font-size: 9px; line-height: 1.4; color: #aaa; }
        .info-text.highlight { color: #4fc3f7; }
        
        /* Bottom Panel */
        .bottom-panel { background: rgba(20,20,40,0.98); border-top: 2px solid #e31e24; height: 0; overflow: hidden; transition: height 0.3s; position: relative; z-index: 100; }
        .bottom-panel.active { height: 340px; overflow-y: auto; }
        .bottom-content { padding: 12px 16px; }
        .bottom-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .bottom-title { font-size: 12px; font-weight: 600; display: flex; align-items: center; gap: 8px; }
        .bottom-subtitle { font-size: 10px; color: #888; }
        
        .bottom-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
        
        /* BHT Impact Section */
        .bht-impact-section { background: rgba(255,255,255,0.02); border-radius: 8px; padding: 12px; }
        .bht-impact-title { font-size: 10px; font-weight: 600; margin-bottom: 10px; color: #4fc3f7; }
        .bht-category { margin-bottom: 8px; }
        .bht-category-header { font-size: 9px; font-weight: 600; padding: 4px 6px; border-radius: 4px; margin-bottom: 4px; display: flex; justify-content: space-between; align-items: center; }
        .bht-category-header.awareness { background: rgba(156,39,176,0.2); color: #ce93d8; }
        .bht-category-header.consideration { background: rgba(255,152,0,0.2); color: #ffb74d; }
        .bht-category-header.conversion { background: rgba(76,175,80,0.2); color: #81c784; }
        .bht-impact-value { font-size: 11px; font-weight: 700; }
        .bht-questions-list { font-size: 8px; color: #aaa; padding-left: 8px; }
        .bht-question-item { padding: 2px 0; display: flex; align-items: center; gap: 4px; }
        .bht-question-item.recommended { color: #fff; }
        .bht-question-item.recommended::before { content: '‚òÖ'; color: #e31e24; }
        
        /* Platform Targeting */
        .platform-section { background: rgba(255,255,255,0.02); border-radius: 8px; padding: 12px; }
        .platform-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; }
        .platform-card { background: rgba(255,255,255,0.03); border-radius: 6px; overflow: hidden; }
        .platform-header { padding: 6px 8px; font-size: 9px; font-weight: 600; display: flex; align-items: center; gap: 5px; }
        .platform-header.meta { background: rgba(24,119,242,0.2); color: #4a90d9; border-bottom: 2px solid #1877f2; }
        .platform-header.x { background: rgba(0,0,0,0.5); color: #fff; border-bottom: 2px solid #000; }
        .platform-header.tiktok { background: rgba(0,0,0,0.4); color: #00f2ea; border-bottom: 2px solid #00f2ea; }
        .platform-header.youtube { background: rgba(255,0,0,0.15); color: #ff6666; border-bottom: 2px solid #ff0000; }
        .platform-header.dv360 { background: rgba(52,168,83,0.2); color: #34a853; border-bottom: 2px solid #34a853; }
        .platform-body { padding: 6px; }
        .targeting-row { display: flex; justify-content: space-between; padding: 3px 0; border-bottom: 1px solid rgba(255,255,255,0.05); font-size: 8px; }
        .targeting-row:last-child { border-bottom: none; }
        .targeting-type { color: #888; }
        .targeting-value { color: #fff; text-align: right; max-width: 60%; }
        .bht-mini { font-size: 6px; padding: 1px 3px; border-radius: 4px; margin-left: 3px; }
        .bht-mini.aw { background: rgba(156,39,176,0.3); color: #ce93d8; }
        .bht-mini.co { background: rgba(255,152,0,0.3); color: #ffb74d; }
        .bht-mini.cv { background: rgba(76,175,80,0.3); color: #81c784; }
        
        .empty-state { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; color: #555; text-align: center; padding: 20px; }
        .empty-icon { font-size: 28px; margin-bottom: 6px; }
        
        .extra-targeting-card { background: rgba(255,255,255,0.03); border-radius: 6px; overflow: hidden; }
        .extra-targeting-header { padding: 6px 8px; font-size: 9px; font-weight: 600; background: rgba(255,255,255,0.05); color: #4fc3f7; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .extra-targeting-body { padding: 6px 8px; }
        .extra-item { display: flex; align-items: center; gap: 6px; padding: 3px 0; font-size: 8px; border-bottom: 1px solid rgba(255,255,255,0.03); }
        .extra-item:last-child { border-bottom: none; }
        .app-icon { width: 18px; height: 18px; border-radius: 4px; display: flex; align-items: center; justify-content: center; font-size: 8px; font-weight: bold; }
        .app-getir { background: #5c3d9e; }
        .app-migros { background: #ff6600; }
        .app-yemeksepeti { background: #fa0050; }
        .app-starbucks { background: #00704A; }
        .app-trendyol { background: #f27a1a; }
        .app-hepsiburada { background: #ff6000; }
        .app-a101 { background: #e30613; }
        .app-bim { background: #ed1c24; }
        .app-nike { background: #111; }
        .app-calm { background: #7eb8da; }
        .app-nefis { background: #e91e63; }
        .app-moov { background: #00a651; }
        .app-obilet { background: #1a73e8; }
        .tv-item { color: #ce93d8; }
        .food-item { color: #ffb74d; font-size: 7px; }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-left">
            <a href="../../" class="nav-btn">‚Üê K√ºt√ºphane</a>
            <a href="../" class="nav-btn">üìä Quadrant</a>
            <div class="logo">
                <div class="logo-icon">PO</div>
                <div class="logo-text">Premium Market</div>
            </div>
        </div>
        <div style="display:flex;gap:5px;">
            <button class="btn btn-secondary" onclick="exportPNG()">üì• PNG</button>
            <button class="btn btn-secondary" onclick="exportExcel()">üìä Excel</button>
        </div>
    </header>
    
    <div class="main-wrapper">
        <div class="top-section">
            <div class="left-panel">
                <div class="panel-header">
                    <div class="panel-title">üìä 40 Segment</div>
                    <div class="filter-row">
                        <button class="filter-btn active" data-tier="all" onclick="filterTier('all')">T√ºm√º</button>
                        <button class="filter-btn" data-tier="super" onclick="filterTier('super')">‚≠ê</button>
                        <button class="filter-btn" data-tier="t1" onclick="filterTier('t1')">T1</button>
                        <button class="filter-btn" data-tier="t2" onclick="filterTier('t2')">T2</button>
                        <button class="filter-btn" data-tier="t3" onclick="filterTier('t3')">T3</button>
                        <button class="filter-btn" data-tier="t4" onclick="filterTier('t4')">T4</button>
                    </div>
                </div>
                <div class="segment-list" id="segmentList"></div>
            </div>
            
            <div class="center-panel">
                <div class="canvas-header">
                    <div class="canvas-title">Segment Quadrant</div>
                    <div class="view-toggle">
                        <button class="view-btn active" onclick="setView('all')">T√ºm√º</button>
                        <button class="view-btn" onclick="setView('Aile Seyahat Planlayƒ±cƒ±larƒ±')">Aile</button>
                        <button class="view-btn" onclick="setView('Deneyim Odaklƒ± ≈ûehirli Premiumlar')">Urban</button>
                        <button class="view-btn" onclick="setView('Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler')">Deƒüer</button>
                        <button class="view-btn" onclick="setView('Eri≈üilebilir Premium T√ºketiciler')">Premium</button>
                    </div>
                </div>
                <div class="canvas-wrap"><canvas id="quadrantCanvas"></canvas></div>
            </div>
            
            <div class="right-panel">
                <div id="emptyState" class="empty-state">
                    <div class="empty-icon">üëÜ</div>
                    <div style="font-size:11px;color:#888;">Segment Se√ßin</div>
                </div>
                <div id="detailPanel" style="display:none;">
                    <div class="detail-section">
                        <div class="detail-header">
                            <div class="tier-badge" id="detailTier">T1</div>
                            <div><div class="detail-name" id="detailName">Segment</div><div class="detail-parent" id="detailParent">Parent</div></div>
                        </div>
                    </div>
                    <div class="detail-section">
                        <div class="detail-title">Metrikler</div>
                        <div class="metrics-grid">
                            <div class="metric-box"><div class="metric-value" id="metricX">50</div><div class="metric-label" id="metricXLabel">X</div></div>
                            <div class="metric-box"><div class="metric-value" id="metricY">50</div><div class="metric-label" id="metricYLabel">Y</div></div>
                            <div class="metric-box"><div class="metric-value" id="metricSize">50</div><div class="metric-label" id="metricSizeLabel">Boyut</div></div>
                            <div class="metric-box"><div class="metric-value" id="metricTier">T1</div><div class="metric-label">√ñncelik</div></div>
                        </div>
                    </div>
                    <div class="detail-section">
                        <div class="detail-title">Strateji</div>
                        <div class="info-text" id="detailReason" style="margin-bottom:4px;"></div>
                        <div class="info-text highlight" id="detailStrategy"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Bottom Panel -->
        <div class="bottom-panel" id="bottomPanel">
            <div class="bottom-content">
                <div class="bottom-header">
                    <div class="bottom-title">
                        <span id="bottomSegName">Segment</span>
                        <span class="bottom-subtitle" id="bottomSegParent"></span>
                    </div>
                </div>
                <div class="bottom-grid">
                    <!-- BHT Impact -->
                    <div class="bht-impact-section">
                        <div class="bht-impact-title">üìä Tahmini BHT Etki Analizi</div>
                        <div class="bht-category">
                            <div class="bht-category-header awareness">
                                <span>üéØ Awareness</span>
                                <span class="bht-impact-value" id="awImpact">+12%</span>
                            </div>
                            <div class="bht-questions-list" id="awQuestions"></div>
                        </div>
                        <div class="bht-category">
                            <div class="bht-category-header consideration">
                                <span>üí≠ Consideration</span>
                                <span class="bht-impact-value" id="coImpact">+8%</span>
                            </div>
                            <div class="bht-questions-list" id="coQuestions"></div>
                        </div>
                        <div class="bht-category">
                            <div class="bht-category-header conversion">
                                <span>‚úÖ Conversion</span>
                                <span class="bht-impact-value" id="cvImpact">+5%</span>
                            </div>
                            <div class="bht-questions-list" id="cvQuestions"></div>
                        </div>
                    </div>
                    
                    <!-- Platform Targeting -->
                    <div class="platform-section">
                        <div class="bht-impact-title">üéØ Platform Hedefleme √ñnerileri</div>
                        <div class="platform-grid">
                            <div class="platform-card">
                                <div class="platform-header meta">üìò Meta</div>
                                <div class="platform-body" id="metaTargeting"></div>
                            </div>
                            <div class="platform-card">
                                <div class="platform-header x">ùïè X</div>
                                <div class="platform-body" id="xTargeting"></div>
                            </div>
                            <div class="platform-card">
                                <div class="platform-header tiktok">üéµ TikTok</div>
                                <div class="platform-body" id="tiktokTargeting"></div>
                            </div>
                            <div class="platform-card">
                                <div class="platform-header youtube">‚ñ∂Ô∏è YouTube</div>
                                <div class="platform-body" id="youtubeTargeting"></div>
                            </div>
                            <div class="platform-card">
                                <div class="platform-header dv360">üìä DV360</div>
                                <div class="platform-body" id="dv360Targeting"></div>
                            </div>
                        </div>
                        
                        <!-- Ek Hedefleme Detaylarƒ± -->
                        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:12px;">
                            <div class="extra-targeting-card">
                                <div class="extra-targeting-header">üì± App Hedefleme</div>
                                <div class="extra-targeting-body" id="appTargeting"></div>
                            </div>
                            <div class="extra-targeting-card">
                                <div class="extra-targeting-header">üì∫ TV & Video ƒ∞lgi Alanlarƒ±</div>
                                <div class="extra-targeting-body" id="tvTargeting"></div>
                            </div>
                            <div class="extra-targeting-card">
                                <div class="extra-targeting-header">üçî Food & Drink Kategorileri</div>
                                <div class="extra-targeting-body" id="foodTargeting"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="tooltip" id="tooltip"></div>
    
    <script>
        const bhtQ = {
            awareness: [
                { id: 'aw1', text: '"Premium Market" konseptini duydum', isNew: true, impact: 15 },
                { id: 'aw2', text: 'PO market hizmeti sunuyor biliyorum', isNew: true, impact: 12 },
                { id: 'aw3', text: 'Kaliteli atƒ±≈ütƒ±rmalƒ±k bulabilirim', isNew: true, impact: 10 },
                { id: 'aw4', text: 'G√ºvenilir bir marka', isNew: false, impact: 5 },
                { id: 'aw5', text: 'Modern ve yenilik√ßi', isNew: false, impact: 8 },
                { id: 'aw6', text: 'Lider marka', isNew: false, impact: 4 }
            ],
            consideration: [
                { id: 'co1', text: 'Yol √ºst√º atƒ±≈ütƒ±rmalƒ±k i√ßin tercih', isNew: true, impact: 12 },
                { id: 'co2', text: 'Premium √ºr√ºnler bulabilirim', isNew: true, impact: 10 },
                { id: 'co3', text: 'Hƒ±zlƒ± kahve i√ßin uƒürarƒ±m', isNew: true, impact: 14 },
                { id: 'co4', text: 'Diƒüer istasyonlardan daha iyi', isNew: true, impact: 8 },
                { id: 'co5', text: 'M√º≈üterisini anlar', isNew: false, impact: 5 },
                { id: 'co6', text: 'ƒ∞stasyonlarƒ± aydƒ±nlƒ±k ve g√ºvenli', isNew: false, impact: 6 },
                { id: 'co7', text: 'Teknolojik √ß√∂z√ºmler sunar', isNew: false, impact: 7 },
                { id: 'co8', text: 'ƒ∞≈üimi hƒ±zlƒ± halledebilirim', isNew: false, impact: 9 }
            ],
            conversion: [
                { id: 'cv1', text: 'Son 1 ayda alƒ±≈üveri≈ü yaptƒ±m', isNew: true, impact: 18 },
                { id: 'cv2', text: 'Sadece market i√ßin gittim', isNew: true, impact: 20 },
                { id: 'cv3', text: 'Tavsiye ederim', isNew: true, impact: 15 },
                { id: 'cv4', text: '√úr√ºnler beklentimi kar≈üƒ±ladƒ±', isNew: true, impact: 12 },
                { id: 'cv5', text: 'Yolumu deƒüi≈ütiririm', isNew: false, impact: 10 },
                { id: 'cv6', text: 'Olmasa eksikliƒüini hissederim', isNew: false, impact: 8 }
            ]
        };

        const segBhtRec = {
            'Aile Seyahat Planlayƒ±cƒ±larƒ±': ['aw2', 'aw3', 'co1', 'co3', 'cv1'],
            'Deneyim Odaklƒ± ≈ûehirli Premiumlar': ['aw1', 'aw5', 'co2', 'co4', 'cv4'],
            'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler': ['aw3', 'co1', 'co8', 'cv1', 'cv2'],
            'Eri≈üilebilir Premium T√ºketiciler': ['aw1', 'aw3', 'co2', 'co3', 'co4', 'cv1', 'cv3', 'cv4']
        };

        const targetT = {
            'Aile Seyahat Planlayƒ±cƒ±larƒ±': {
                meta: [
                    { type: 'Interest', target: 'Seyahat, Aile tatili, Kamp', bht: 'aw' },
                    { type: 'Behavior', target: 'Sƒ±k seyahat edenler', bht: 'co' },
                    { type: 'Custom', target: 'PO app users', bht: 'cv' }
                ],
                x: [
                    { type: 'Trend Takeover', target: '#HaftaSonuKa√ßamaƒüƒ±', bht: 'aw' },
                    { type: 'Timeline Takeover', target: 'ƒ∞lk 24 saat g√∂r√ºn√ºrl√ºk', bht: 'aw' },
                    { type: 'Keyword', target: 'tatil, yolculuk, gezi', bht: 'co' },
                    { type: 'Follower LA', target: '@KulturYollari @obiabordam', bht: 'co' },
                    { type: 'Engagement', target: 'Video g√∂r√ºnt√ºleyenler', bht: 'cv' }
                ],
                tiktok: [
                    { type: 'Hashtag', target: '#aileiletatil #yolculuk', bht: 'aw' },
                    { type: 'Creator', target: 'Aile/seyahat influencer', bht: 'co' },
                    { type: 'Retarget', target: 'Video %50+ izleyenler', bht: 'cv' }
                ],
                youtube: [
                    { type: 'Affinity', target: 'Travel Buffs, Family-Focused', bht: 'aw' },
                    { type: 'In-Market', target: 'Family Vacations, Auto Fuel', bht: 'co' },
                    { type: 'Remarketing', target: 'Kanal aboneleri', bht: 'cv' }
                ],
                dv360: [
                    { type: 'Affinity', target: 'Travel Buffs, Family-Focused, Outdoor Enthusiasts', bht: 'aw' },
                    { type: 'In-Market', target: 'Travel/Hotels, Auto Fuel & Charging', bht: 'co' },
                    { type: 'Custom Intent', target: 'aile tatili rotasƒ±, yol gezisi', bht: 'cv' }
                ],
                apps: ['Getir', 'Migros', 'Yemeksepeti', 'Moov by Garanti', 'Obilet'],
                tvCategories: ['TV Family-Oriented Shows', 'TV Reality Shows', 'TV Talent & Variety Shows'],
                foodCategories: ['/Food & Drink/Restaurants/Fast Food', '/Food & Drink/Beverages/Soft Drinks', '/Food & Drink/Food/Candy & Sweets']
            },
            'Deneyim Odaklƒ± ≈ûehirli Premiumlar': {
                meta: [
                    { type: 'Interest', target: 'Wellness, Fitness, Organik', bht: 'aw' },
                    { type: 'Behavior', target: 'Health conscious, Early adopters', bht: 'co' },
                    { type: 'Lookalike', target: 'Premium m√º≈üteri LAL %1-2', bht: 'cv' }
                ],
                x: [
                    { type: 'Trend Takeover', target: '#PremiumAnlar', bht: 'aw' },
                    { type: 'Timeline Takeover', target: 'Sabah saatleri (07-10)', bht: 'aw' },
                    { type: 'Keyword', target: 'kahve, wellness, premium', bht: 'co' },
                    { type: 'Follower LA', target: '@Starbucks_TR @Nike', bht: 'co' },
                    { type: 'Website Retarget', target: 'Premium sayfa ziyaret√ßileri', bht: 'cv' }
                ],
                tiktok: [
                    { type: 'Hashtag', target: '#wellness #saƒülƒ±klƒ±ya≈üam', bht: 'aw' },
                    { type: 'Creator', target: 'Lifestyle/wellness creators', bht: 'co' },
                    { type: 'Retarget', target: 'Engaged users 7 g√ºn', bht: 'cv' }
                ],
                youtube: [
                    { type: 'Affinity', target: 'Health & Fitness Buffs, Foodies', bht: 'aw' },
                    { type: 'In-Market', target: 'Health Food, Premium Beverages', bht: 'co' },
                    { type: 'Remarketing', target: 'High-value viewers', bht: 'cv' }
                ],
                dv360: [
                    { type: 'Affinity', target: 'Coffee Shop Regulars, Health & Fitness Buffs, Foodies', bht: 'aw' },
                    { type: 'In-Market', target: 'Health Food, Coffee, Organic Products', bht: 'co' },
                    { type: 'Custom Intent', target: 'specialty coffee, organik √ºr√ºn', bht: 'cv' }
                ],
                apps: ['Starbucks', 'Nefis Yemek Tarifleri', 'Nike Training', 'Calm', 'Headspace'],
                tvCategories: ['TV Talk Shows', 'TV Sci-Fi & Fantasy Shows', 'TV Comedies'],
                foodCategories: ['/Food & Drink/Beverages/Energy Drinks', '/Food & Drink/Beverages/Nutrition Drinks & Shakes', '/Food & Drink/Food/Grains & Pasta']
            },
            'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler': {
                meta: [
                    { type: 'Interest', target: 'Fƒ±rsatlar, ƒ∞ndirimler, Kuponlar', bht: 'aw' },
                    { type: 'Behavior', target: 'Deal seekers, Coupon users', bht: 'co' },
                    { type: 'Custom', target: 'Sadakat programƒ± √ºyeleri', bht: 'cv' }
                ],
                x: [
                    { type: 'Trend Takeover', target: '#FlashFƒ±rsat #Kampanya', bht: 'aw' },
                    { type: 'Amplify Pre-roll', target: 'Haber & g√ºndem i√ßerikleri', bht: 'aw' },
                    { type: 'Keyword', target: 'indirim, kampanya, fƒ±rsat', bht: 'co' },
                    { type: 'Follower LA', target: '@A101 @BIM_Magazalari', bht: 'co' },
                    { type: 'Engagement', target: 'Kupon RT yapanlar', bht: 'cv' }
                ],
                tiktok: [
                    { type: 'Hashtag', target: '#indirim #fƒ±rsat #tasarruf', bht: 'aw' },
                    { type: 'Creator', target: 'Fƒ±rsat/para biriktirme creators', bht: 'co' },
                    { type: 'Retarget', target: 'Profil ziyaret√ßileri', bht: 'cv' }
                ],
                youtube: [
                    { type: 'Affinity', target: 'Bargain Hunters, Value Shoppers', bht: 'aw' },
                    { type: 'In-Market', target: 'Coupons & Discount Offers', bht: 'co' },
                    { type: 'Remarketing', target: 'Deal sayfasƒ± izleyicileri', bht: 'cv' }
                ],
                dv360: [
                    { type: 'Affinity', target: 'Bargain Hunters, Value Shoppers, Coupon Savers', bht: 'aw' },
                    { type: 'In-Market', target: 'Coupons & Discounts, Convenience Stores', bht: 'co' },
                    { type: 'Custom Intent', target: 'indirim kampanya fƒ±rsat', bht: 'cv' }
                ],
                apps: ['Getir', 'Trendyol', 'Hepsiburada', 'A101', 'Bƒ∞M'],
                tvCategories: ['TV Game Shows', 'TV Reality Shows', 'TV Soap Operas'],
                foodCategories: ['/Food & Drink/Restaurants/Fast Food', '/Food & Drink/Food/Candy & Sweets', '/Food & Drink/Beverages/Soft Drinks']
            },
            'Eri≈üilebilir Premium T√ºketiciler': {
                meta: [
                    { type: 'Interest', target: 'Self-care, Premium kahve, Treats', bht: 'aw' },
                    { type: 'Behavior', target: 'Impulse buyers, Upgraders', bht: 'co' },
                    { type: 'Lookalike', target: 'Premium alƒ±cƒ±lar LAL %1-3', bht: 'cv' }
                ],
                x: [
                    { type: 'Trend Takeover', target: '#Kendine√ñd√ºl #G√ºn√ºnKeyfi', bht: 'aw' },
                    { type: 'Timeline Takeover', target: '√ñƒüle molasƒ± (12-14)', bht: 'aw' },
                    { type: 'Keyword', target: 'kahve keyfi, mola, ≈üƒ±martmak', bht: 'co' },
                    { type: 'Follower LA', target: '@Starbucks_TR @PetrolOfisi', bht: 'co' },
                    { type: 'Website Retarget', target: 'Market sayfasƒ± ziyaret√ßileri', bht: 'cv' }
                ],
                tiktok: [
                    { type: 'Hashtag', target: '#kendini≈üƒ±mart #kahvekeyfi', bht: 'aw' },
                    { type: 'Creator', target: 'Lifestyle/kahve creators', bht: 'co' },
                    { type: 'Retarget', target: 'High-intent viewers', bht: 'cv' }
                ],
                youtube: [
                    { type: 'Affinity', target: 'Coffee Shop Regulars, Foodies', bht: 'aw' },
                    { type: 'In-Market', target: 'Coffee, Premium Snacks', bht: 'co' },
                    { type: 'Remarketing', target: 'Converters', bht: 'cv' }
                ],
                dv360: [
                    { type: 'Affinity', target: 'Coffee Shop Regulars, Foodies, Fast Food Cravers', bht: 'aw' },
                    { type: 'In-Market', target: 'Coffee, Snack Foods, Convenience Stores', bht: 'co' },
                    { type: 'Custom Intent', target: 'premium kahve grab and go', bht: 'cv' }
                ],
                apps: ['Starbucks', 'Getir', 'Yemeksepeti', 'Migros', 'Nefis Yemek Tarifleri'],
                tvCategories: ['TV Comedies', 'TV Talk Shows', 'TV Talent & Variety Shows'],
                foodCategories: ['/Food & Drink/Beverages/Energy Drinks', '/Food & Drink/Food/Candy & Sweets', '/Food & Drink/Restaurants/Street Food']
            }
        };

        const segments = [
            { parent: 'Aile Seyahat Planlayƒ±cƒ±larƒ±', name: 'Hafta Sonu Ka√ßamak√ßƒ±larƒ±', x: 65, y: 90, size: 95, tier: 'T1', reason: 'Her hafta sonu yola √ßƒ±kƒ±yor.', strategy: '"Hafta Sonu Paketi" combo' },
            { parent: 'Aile Seyahat Planlayƒ±cƒ±larƒ±', name: 'Aile Yol Gezisi Tutkunlarƒ±', x: 55, y: 70, size: 90, tier: 'T1', reason: 'Uzun yol = √ßoklu durak.', strategy: '"Yol Arkada≈üƒ±" seti' },
            { parent: 'Aile Seyahat Planlayƒ±cƒ±larƒ±', name: 'G√ºvenlik √ñncelikli Maceracƒ±lar', x: 75, y: 65, size: 75, tier: 'T2', reason: 'Premium √∂demeye hazƒ±r.', strategy: 'Kalite vurgulu' },
            { parent: 'Aile Seyahat Planlayƒ±cƒ±larƒ±', name: 'Tema Parkƒ± Meraklƒ±larƒ±', x: 45, y: 60, size: 70, tier: 'T2', reason: 'Sƒ±k seyahat.', strategy: 'Aile paketi' },
            { parent: 'Aile Seyahat Planlayƒ±cƒ±larƒ±', name: 'Aile Kamp Planlayƒ±cƒ±larƒ±', x: 40, y: 55, size: 65, tier: 'T2', reason: 'Pratik √ºr√ºn.', strategy: '"Kamp Essentials"' },
            { parent: 'Aile Seyahat Planlayƒ±cƒ±larƒ±', name: 'Sezonluk Tatilciler', x: 50, y: 25, size: 60, tier: 'T3', reason: 'Yƒ±lda 1-2 kez.', strategy: 'Sezonsal' },
            { parent: 'Aile Seyahat Planlayƒ±cƒ±larƒ±', name: '√áok Ku≈üaklƒ± Planlayƒ±cƒ±lar', x: 60, y: 35, size: 55, tier: 'T3', reason: 'B√ºy√ºk aile.', strategy: 'Aile boyu' },
            { parent: 'Aile Seyahat Planlayƒ±cƒ±larƒ±', name: 'Eƒüitici Gezi Arayanlar', x: 55, y: 30, size: 45, tier: 'T3', reason: 'Ni≈ü kitle.', strategy: 'K√ºlt√ºr rotalarƒ±' },
            { parent: 'Aile Seyahat Planlayƒ±cƒ±larƒ±', name: 'Seyahat Puanƒ± Optimizecileri', x: 30, y: 75, size: 50, tier: 'T4', reason: 'Sadakat d√º≈ü√ºk.', strategy: 'Puan √ßarpanƒ±' },
            { parent: 'Aile Seyahat Planlayƒ±cƒ±larƒ±', name: 'B√ºt√ße Dostu Aile Tatilcileri', x: 20, y: 45, size: 55, tier: 'T4', reason: 'Fiyat hassas.', strategy: 'Private label' },
            { parent: 'Deneyim Odaklƒ± ≈ûehirli Premiumlar', name: '≈ûehirli Wellness Arayanlar', x: 85, y: 70, size: 90, tier: 'T1', reason: 'G√ºnl√ºk premium kahve.', strategy: 'Protein, cold-press' },
            { parent: 'Deneyim Odaklƒ± ≈ûehirli Premiumlar', name: 'Premium Teknoloji √ñnc√ºleri', x: 80, y: 75, size: 75, tier: 'T1', reason: 'Grab & go.', strategy: 'Specialty coffee' },
            { parent: 'Deneyim Odaklƒ± ≈ûehirli Premiumlar', name: 'L√ºks Macera Gezginleri', x: 75, y: 85, size: 65, tier: 'T2', reason: 'Kaliteli √ºr√ºn.', strategy: 'Trail mix' },
            { parent: 'Deneyim Odaklƒ± ≈ûehirli Premiumlar', name: 'Premium Seyahat Ustalarƒ±', x: 70, y: 90, size: 55, tier: 'T2', reason: 'Y√ºksek kalite.', strategy: 'Gourmet' },
            { parent: 'Deneyim Odaklƒ± ≈ûehirli Premiumlar', name: 'K√ºlt√ºrel Deneyim Koleksiyoncularƒ±', x: 50, y: 65, size: 55, tier: 'T2', reason: 'K√ºlt√ºr turlarƒ±.', strategy: 'Yerel lezzet' },
            { parent: 'Deneyim Odaklƒ± ≈ûehirli Premiumlar', name: 'Fine Dining Tutkunlarƒ±', x: 45, y: 85, size: 50, tier: 'T3', reason: 'Convenience deƒüil.', strategy: 'Artisan' },
            { parent: 'Deneyim Odaklƒ± ≈ûehirli Premiumlar', name: 'L√ºks Ya≈üam Tarzƒ± Meraklƒ±larƒ±', x: 55, y: 95, size: 45, tier: 'T3', reason: '√ñzel kanal.', strategy: 'Premium imaj' },
            { parent: 'Deneyim Odaklƒ± ≈ûehirli Premiumlar', name: 'Butik Moda Takip√ßileri', x: 40, y: 70, size: 40, tier: 'T4', reason: 'D√º≈ü√ºk √∂ncelik.', strategy: 'D√º≈ü√ºk' },
            { parent: 'Deneyim Odaklƒ± ≈ûehirli Premiumlar', name: 'Sanat & Tiyatro Hamileri', x: 35, y: 60, size: 45, tier: 'T4', reason: 'Rutin az.', strategy: 'D√º≈ü√ºk' },
            { parent: 'Deneyim Odaklƒ± ≈ûehirli Premiumlar', name: 'Yat & Country Club √úyeleri', x: 30, y: 95, size: 30, tier: 'T4', reason: 'Kapalƒ±.', strategy: 'Ula≈üƒ±lamaz' },
            { parent: 'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler', name: 'Flash ƒ∞ndirim Tutkunlarƒ±', x: 75, y: 90, size: 85, tier: 'T1', reason: 'Anlƒ±k alƒ±r.', strategy: 'Flash deal' },
            { parent: 'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler', name: 'Puan & √ñd√ºl Koleksiyoncularƒ±', x: 55, y: 85, size: 80, tier: 'T1', reason: 'Program sadƒ±k.', strategy: 'Puan √ßarpanƒ±' },
            { parent: 'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler', name: 'Fƒ±rsat Avcƒ±sƒ± Alƒ±≈üveri≈ü√ßiler', x: 80, y: 75, size: 75, tier: 'T2', reason: 'Aktif fƒ±rsat.', strategy: 'Haftalƒ±k insert' },
            { parent: 'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler', name: 'Sadece Temel ƒ∞htiya√ß Alƒ±cƒ±larƒ±', x: 60, y: 65, size: 75, tier: 'T2', reason: 'D√ºzenli.', strategy: 'Fiyat liderliƒüi' },
            { parent: 'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler', name: 'ƒ∞ndirim Maksimizecileri', x: 85, y: 70, size: 70, tier: 'T2', reason: 'Promosyon.', strategy: '√áoklu al' },
            { parent: 'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler', name: 'Jenerik Marka Se√ßiciler', x: 90, y: 60, size: 65, tier: 'T3', reason: 'Private label.', strategy: 'PO √∂zel marka' },
            { parent: 'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler', name: 'ƒ∞ndirim K√∂≈üesi Gezginleri', x: 85, y: 45, size: 50, tier: 'T3', reason: 'K√∂≈üe avcƒ±sƒ±.', strategy: 'Endcap' },
            { parent: 'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler', name: 'Toplu Alƒ±m Yapanlar', x: 70, y: 35, size: 55, tier: 'T4', reason: 'Format uyumsuz.', strategy: 'D√º≈ü√ºk' },
            { parent: 'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler', name: 'Fiyat E≈üleme Talep Edenler', x: 95, y: 50, size: 45, tier: 'T4', reason: 'Y√ºksek efor.', strategy: 'D√º≈ü√ºk' },
            { parent: 'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler', name: 'ƒ∞kinci El Alƒ±≈üveri≈ü√ßiler', x: 80, y: 30, size: 35, tier: 'T4', reason: 'Hedef dƒ±≈üƒ±.', strategy: 'D√º≈ü√ºk' },
            { parent: 'Eri≈üilebilir Premium T√ºketiciler', name: 'Kolaylƒ±k Premium Arayanlar', x: 90, y: 80, size: 95, tier: 'S√ºper', reason: 'Hƒ±z + kalite. Bi√ßilmi≈ü kaftan.', strategy: '"2 Dakika Garantisi"' },
            { parent: 'Eri≈üilebilir Premium T√ºketiciler', name: 'Kendine √ñd√ºl Verenler', x: 95, y: 70, size: 90, tier: 'S√ºper', reason: '"Bunu hak ettim" anƒ±.', strategy: '"Bug√ºn Senin G√ºn√ºn"' },
            { parent: 'Eri≈üilebilir Premium T√ºketiciler', name: 'G√ºnl√ºk Premium Y√ºkseltmeciler', x: 75, y: 75, size: 85, tier: 'T1', reason: 'Her g√ºn upgrade.', strategy: '"Upgrade Your Day"' },
            { parent: 'Eri≈üilebilir Premium T√ºketiciler', name: 'Premium Kahve Tutkunlarƒ±', x: 70, y: 85, size: 85, tier: 'T1', reason: 'Kahve = rit√ºel.', strategy: '"6. Kahve Bedava"' },
            { parent: 'Eri≈üilebilir Premium T√ºketiciler', name: 'Son Dakika Premium √ñdeyiciler', x: 85, y: 75, size: 80, tier: 'T1', reason: 'Acil = premium.', strategy: '"ƒ∞htiya√ß Anƒ±nda"' },
            { parent: 'Eri≈üilebilir Premium T√ºketiciler', name: 'Talep √úzerine Ya≈üam Tarzƒ±', x: 80, y: 70, size: 75, tier: 'T2', reason: 'Hƒ±z > fiyat.', strategy: '"Pre-Order & Pick"' },
            { parent: 'Eri≈üilebilir Premium T√ºketiciler', name: 'Kalite Bilin√ßli D√ºrt√ºsel Alƒ±cƒ±lar', x: 85, y: 80, size: 70, tier: 'T2', reason: 'Kalite filtreli.', strategy: '"Haftanƒ±n Ke≈üfi"' },
            { parent: 'Eri≈üilebilir Premium T√ºketiciler', name: 'Organik & Doƒüal Se√ßiciler', x: 55, y: 85, size: 60, tier: 'T2', reason: 'Saƒülƒ±k bilin√ßli.', strategy: '"Clean Label"' },
            { parent: 'Eri≈üilebilir Premium T√ºketiciler', name: 'Artisan √úr√ºn Destek√ßileri', x: 50, y: 90, size: 45, tier: 'T3', reason: '√áok se√ßici.', strategy: '"Yerel Lezzet"' },
            { parent: 'Eri≈üilebilir Premium T√ºketiciler', name: 'Abonelik Servisi Benimseyenler', x: 40, y: 70, size: 55, tier: 'T4', reason: 'Abonelik odaklƒ±.', strategy: 'D√º≈ü√ºk' }
        ];

        const parentColors = {
            'Aile Seyahat Planlayƒ±cƒ±larƒ±': { bg: 'rgba(33,150,243,0.25)', border: '#2196f3' },
            'Deneyim Odaklƒ± ≈ûehirli Premiumlar': { bg: 'rgba(156,39,176,0.25)', border: '#9c27b0' },
            'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler': { bg: 'rgba(255,152,0,0.25)', border: '#ff9800' },
            'Eri≈üilebilir Premium T√ºketiciler': { bg: 'rgba(76,175,80,0.25)', border: '#4caf50' }
        };
        const tierCfg = { 'S√ºper': { icon: '‚≠ê', class: 'tier-super' }, 'T1': { icon: 'T1', class: 'tier-t1' }, 'T2': { icon: 'T2', class: 'tier-t2' }, 'T3': { icon: 'T3', class: 'tier-t3' }, 'T4': { icon: 'T4', class: 'tier-t4' } };
        const axisL = {
            'Aile Seyahat Planlayƒ±cƒ±larƒ±': { x: 'Premium A√ßƒ±klƒ±k', y: 'Frekans', s: 'Potansiyel' },
            'Deneyim Odaklƒ± ≈ûehirli Premiumlar': { x: 'Convenience', y: 'Premium Kapasite', s: 'Pazar' },
            'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler': { x: 'Fiyat Odaklƒ±lƒ±k', y: 'Alƒ±≈üveri≈ü Frekansƒ±', s: 'Hacim' },
            'Eri≈üilebilir Premium T√ºketiciler': { x: 'D√ºrt√ºsellik', y: 'Premium ƒ∞stek', s: 'Deƒüer' }
        };

        let canvas, ctx, selectedSeg = null, currentFilter = 'all', currentView = 'all';
        const pad = 45;

        function init() {
            canvas = document.getElementById('quadrantCanvas');
            ctx = canvas.getContext('2d');
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
            canvas.addEventListener('mousemove', handleMouseMove);
            canvas.addEventListener('click', handleClick);
            canvas.addEventListener('mouseleave', () => document.getElementById('tooltip').style.display = 'none');
            renderSegmentList();
            draw();
        }

        function resizeCanvas() { const c = canvas.parentElement; canvas.width = c.clientWidth; canvas.height = c.clientHeight; draw(); }

        function renderSegmentList() {
            const groups = {};
            segments.forEach((s, i) => { if (!groups[s.parent]) groups[s.parent] = []; groups[s.parent].push({ ...s, index: i }); });
            const list = document.getElementById('segmentList');
            list.innerHTML = '';
            Object.entries(groups).forEach(([parent, segs]) => {
                const colors = parentColors[parent];
                const div = document.createElement('div');
                div.className = 'segment-group';
                div.innerHTML = `<div class="segment-group-header" style="border-left-color:${colors.border};" onclick="toggleGroup(this)"><span>${parent.split(' ').slice(0, 2).join(' ')}</span><span>‚ñº</span></div><div class="segment-items open">${segs.map(s => `<div class="segment-item ${selectedSeg === s.index ? 'selected' : ''}" onclick="selectSegment(${s.index})"><div class="tier-badge ${tierCfg[s.tier].class}">${tierCfg[s.tier].icon}</div><span>${s.name}</span></div>`).join('')}</div>`;
                list.appendChild(div);
            });
        }

        function toggleGroup(h) { const i = h.nextElementSibling; i.classList.toggle('open'); h.querySelector('span:last-child').textContent = i.classList.contains('open') ? '‚ñº' : '‚ñ∂'; }
        function getFiltered() {
            let f = segments;
            if (currentFilter !== 'all') { const m = { 'super': 'S√ºper', 't1': 'T1', 't2': 'T2', 't3': 'T3', 't4': 'T4' }; f = f.filter(s => s.tier === m[currentFilter]); }
            if (currentView !== 'all') f = f.filter(s => s.parent === currentView);
            return f;
        }

        function draw() {
            const w = canvas.width, h = canvas.height;
            ctx.fillStyle = '#0f0f1a'; ctx.fillRect(0, 0, w, h);
            const cw = w - pad * 2, ch = h - pad * 2, cx = pad + cw / 2, cy = pad + ch / 2;
            ctx.fillStyle = 'rgba(255,152,0,0.04)'; ctx.fillRect(pad, pad, cw / 2, ch / 2);
            ctx.fillStyle = 'rgba(76,175,80,0.06)'; ctx.fillRect(cx, pad, cw / 2, ch / 2);
            ctx.fillStyle = 'rgba(244,67,54,0.04)'; ctx.fillRect(pad, cy, cw / 2, ch / 2);
            ctx.fillStyle = 'rgba(33,150,243,0.04)'; ctx.fillRect(cx, cy, cw / 2, ch / 2);
            ctx.strokeStyle = 'rgba(255,255,255,0.05)'; ctx.lineWidth = 1;
            for (let i = 0; i <= 10; i++) { ctx.beginPath(); ctx.moveTo(pad + (cw / 10) * i, pad); ctx.lineTo(pad + (cw / 10) * i, h - pad); ctx.stroke(); ctx.beginPath(); ctx.moveTo(pad, pad + (ch / 10) * i); ctx.lineTo(w - pad, pad + (ch / 10) * i); ctx.stroke(); }
            ctx.strokeStyle = 'rgba(255,255,255,0.2)'; ctx.lineWidth = 2;
            ctx.beginPath(); ctx.moveTo(cx, pad); ctx.lineTo(cx, h - pad); ctx.stroke();
            ctx.beginPath(); ctx.moveTo(pad, cy); ctx.lineTo(w - pad, cy); ctx.stroke();
            ctx.font = '9px Segoe UI'; ctx.fillStyle = 'rgba(255,255,255,0.5)'; ctx.textAlign = 'center';
            ctx.fillText('Planlƒ± & Lifestyle', pad + cw / 4, pad + 14);
            ctx.fillText('D√ºrt√ºsel & Lifestyle', cx + cw / 4, pad + 14);
            ctx.fillText('Planlƒ± & Fonksiyonel', pad + cw / 4, h - pad - 8);
            ctx.fillText('D√ºrt√ºsel & Fonksiyonel', cx + cw / 4, h - pad - 8);
            const filtered = getFiltered();
            filtered.forEach(seg => {
                const ri = segments.indexOf(seg), x = pad + (seg.x / 100) * cw, y = pad + ((100 - seg.y) / 100) * ch, size = (seg.size / 100) * 22 + 6, colors = parentColors[seg.parent];
                if (selectedSeg === ri) { ctx.beginPath(); ctx.arc(x, y, size + 4, 0, Math.PI * 2); ctx.fillStyle = 'rgba(227,30,36,0.3)'; ctx.fill(); }
                ctx.beginPath(); ctx.arc(x, y, size, 0, Math.PI * 2); ctx.fillStyle = colors.bg; ctx.fill(); ctx.strokeStyle = colors.border; ctx.lineWidth = selectedSeg === ri ? 3 : 1.5; ctx.stroke();
                ctx.fillStyle = tierCfg[seg.tier].class === 'tier-super' ? '#ffd700' : '#fff'; ctx.font = `bold ${size > 16 ? 8 : 6}px Segoe UI`; ctx.textAlign = 'center'; ctx.textBaseline = 'middle'; ctx.fillText(tierCfg[seg.tier].icon, x, y);
            });
        }

        function handleMouseMove(e) {
            const rect = canvas.getBoundingClientRect(), mx = e.clientX - rect.left, my = e.clientY - rect.top, cw = canvas.width - pad * 2, ch = canvas.height - pad * 2;
            let found = null;
            getFiltered().forEach(seg => { const x = pad + (seg.x / 100) * cw, y = pad + ((100 - seg.y) / 100) * ch, size = (seg.size / 100) * 22 + 6; if (Math.sqrt((mx - x) ** 2 + (my - y) ** 2) < size) found = seg; });
            const tt = document.getElementById('tooltip');
            if (found) { canvas.style.cursor = 'pointer'; const l = axisL[found.parent]; tt.innerHTML = `<div style="font-weight:600;">${found.name}</div><div style="color:#888;font-size:8px;margin:3px 0;">${found.parent}</div><div style="font-size:8px;">${l.x}: <b style="color:#e31e24;">${found.x}</b> | ${l.y}: <b style="color:#e31e24;">${found.y}</b></div>`; tt.style.display = 'block'; tt.style.left = (e.clientX + 12) + 'px'; tt.style.top = (e.clientY + 12) + 'px'; }
            else { canvas.style.cursor = 'default'; tt.style.display = 'none'; }
        }

        function handleClick(e) {
            const rect = canvas.getBoundingClientRect(), mx = e.clientX - rect.left, my = e.clientY - rect.top, cw = canvas.width - pad * 2, ch = canvas.height - pad * 2;
            let found = null;
            getFiltered().forEach(seg => { const ri = segments.indexOf(seg), x = pad + (seg.x / 100) * cw, y = pad + ((100 - seg.y) / 100) * ch, size = (seg.size / 100) * 22 + 6; if (Math.sqrt((mx - x) ** 2 + (my - y) ** 2) < size) found = ri; });
            selectSegment(found);
        }

        function selectSegment(idx) {
            selectedSeg = idx;
            renderSegmentList();
            draw();
            document.getElementById('emptyState').style.display = idx === null ? 'flex' : 'none';
            document.getElementById('detailPanel').style.display = idx === null ? 'none' : 'block';
            document.getElementById('bottomPanel').classList.toggle('active', idx !== null);
            
            if (idx !== null) {
                const seg = segments[idx], l = axisL[seg.parent], tier = tierCfg[seg.tier];
                document.getElementById('detailTier').className = 'tier-badge ' + tier.class;
                document.getElementById('detailTier').textContent = tier.icon;
                document.getElementById('detailName').textContent = seg.name;
                document.getElementById('detailParent').textContent = seg.parent;
                document.getElementById('metricX').textContent = seg.x;
                document.getElementById('metricY').textContent = seg.y;
                document.getElementById('metricSize').textContent = seg.size;
                document.getElementById('metricTier').textContent = seg.tier;
                document.getElementById('metricXLabel').textContent = l.x;
                document.getElementById('metricYLabel').textContent = l.y;
                document.getElementById('metricSizeLabel').textContent = l.s;
                document.getElementById('detailReason').textContent = seg.reason;
                document.getElementById('detailStrategy').textContent = seg.strategy;
                
                document.getElementById('bottomSegName').textContent = seg.name;
                document.getElementById('bottomSegParent').textContent = '/ ' + seg.parent;
                
                renderBhtImpact(seg.parent);
                renderPlatformTargeting(seg.parent);
            }
        }

        function renderBhtImpact(parent) {
            const recs = segBhtRec[parent] || [];
            
            ['awareness', 'consideration', 'conversion'].forEach(cat => {
                const questions = bhtQ[cat];
                const catRecs = recs.filter(r => questions.find(q => q.id === r));
                let totalImpact = 0;
                
                const html = questions.map(q => {
                    const isRec = recs.includes(q.id);
                    if (isRec) totalImpact += q.impact;
                    return `<div class="bht-question-item ${isRec ? 'recommended' : ''}">${q.text}</div>`;
                }).join('');
                
                const prefix = cat === 'awareness' ? 'aw' : cat === 'consideration' ? 'co' : 'cv';
                document.getElementById(prefix + 'Questions').innerHTML = html;
                document.getElementById(prefix + 'Impact').textContent = '+' + totalImpact + '%';
            });
        }

        function renderPlatformTargeting(parent) {
            const t = targetT[parent] || targetT['Eri≈üilebilir Premium T√ºketiciler'];
            
            ['meta', 'x', 'tiktok', 'youtube', 'dv360'].forEach(p => {
                const data = t[p] || [];
                document.getElementById(p + 'Targeting').innerHTML = data.map(r => `
                    <div class="targeting-row">
                        <span class="targeting-type">${r.type}</span>
                        <span class="targeting-value">${r.target}<span class="bht-mini ${r.bht}">${r.bht.toUpperCase()}</span></span>
                    </div>
                `).join('');
            });
            
            // App Targeting
            const appColors = {
                'Getir': 'getir', 'Migros': 'migros', 'Yemeksepeti': 'yemeksepeti', 
                'Starbucks': 'starbucks', 'Trendyol': 'trendyol', 'Hepsiburada': 'hepsiburada',
                'A101': 'a101', 'Bƒ∞M': 'bim', 'Nike Training': 'nike', 'Calm': 'calm',
                'Nefis Yemek Tarifleri': 'nefis', 'Moov by Garanti': 'moov', 'Obilet': 'obilet', 'Headspace': 'calm'
            };
            document.getElementById('appTargeting').innerHTML = (t.apps || []).map(app => `
                <div class="extra-item">
                    <div class="app-icon app-${appColors[app] || 'getir'}">${app.charAt(0)}</div>
                    <span>${app}</span>
                </div>
            `).join('');
            
            // TV Categories
            document.getElementById('tvTargeting').innerHTML = (t.tvCategories || []).map(cat => `
                <div class="extra-item tv-item">üì∫ ${cat}</div>
            `).join('');
            
            // Food Categories
            document.getElementById('foodTargeting').innerHTML = (t.foodCategories || []).map(cat => `
                <div class="extra-item food-item">üçî ${cat}</div>
            `).join('');
        }

        function filterTier(t) { currentFilter = t; document.querySelectorAll('.filter-btn').forEach(b => b.classList.toggle('active', b.dataset.tier === t)); draw(); }
        function setView(v) { currentView = v; document.querySelectorAll('.view-btn').forEach(b => { const isA = (v === 'all' && b.textContent === 'T√ºm√º') || (v === 'Aile Seyahat Planlayƒ±cƒ±larƒ±' && b.textContent === 'Aile') || (v === 'Deneyim Odaklƒ± ≈ûehirli Premiumlar' && b.textContent === 'Urban') || (v === 'Deƒüer Odaklƒ± Hƒ±zlƒ± Alƒ±≈üveri≈ü√ßiler' && b.textContent === 'Deƒüer') || (v === 'Eri≈üilebilir Premium T√ºketiciler' && b.textContent === 'Premium'); b.classList.toggle('active', isA); }); draw(); }
        function exportPNG() { const l = document.createElement('a'); l.download = 'po-quadrant.png'; l.href = canvas.toDataURL('image/png'); l.click(); }
        function exportExcel() { let h = '<html><head><meta charset="UTF-8"></head><body><table border="1"><tr><th>Ana</th><th>Alt</th><th>X</th><th>Y</th><th>Size</th><th>Tier</th><th>Gerek√ße</th><th>Strateji</th></tr>'; segments.forEach(s => { h += `<tr><td>${s.parent}</td><td>${s.name}</td><td>${s.x}</td><td>${s.y}</td><td>${s.size}</td><td>${s.tier}</td><td>${s.reason}</td><td>${s.strategy}</td></tr>`; }); h += '</table></body></html>'; const b = new Blob([h], { type: 'application/vnd.ms-excel' }), l = document.createElement('a'); l.href = URL.createObjectURL(b); l.download = 'po-segments.xls'; l.click(); }
        window.onload = init;
    </script>
</body>
</html>
